<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Generic.Semantics.Printing</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Pragma">--sized-types</a> <a id="34" class="Symbol">#-}</a>

<a id="39" class="Keyword">module</a> <a id="46" href="Generic.Semantics.Printing.html" class="Module">Generic.Semantics.Printing</a> <a id="73" class="Symbol">{</a><a id="74" href="Generic.Semantics.Printing.html#74" class="Bound">I</a> <a id="76" class="Symbol">:</a> <a id="78" class="PrimitiveType">Set</a><a id="81" class="Symbol">}</a> <a id="83" class="Keyword">where</a>

<a id="90" class="Keyword">open</a> <a id="95" class="Keyword">import</a> <a id="102" href="Codata.Stream.html" class="Module">Codata.Stream</a> <a id="116" class="Keyword">using</a> <a id="122" class="Symbol">(</a><a id="123" href="Codata.Stream.html#695" class="Datatype">Stream</a><a id="129" class="Symbol">)</a>
<a id="131" class="Keyword">open</a> <a id="136" class="Keyword">import</a> <a id="143" href="Size.html" class="Module">Size</a>
<a id="148" class="Keyword">open</a> <a id="153" class="Keyword">import</a> <a id="160" href="Data.Product.html" class="Module">Data.Product</a>
<a id="173" class="Keyword">open</a> <a id="178" class="Keyword">import</a> <a id="185" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="200" class="Keyword">using</a> <a id="206" class="Symbol">(</a><a id="207" href="Agda.Builtin.List.html#121" class="Datatype">List</a><a id="211" class="Symbol">;</a> <a id="213" href="Data.List.Base.html#9863" class="InductiveConstructor">[]</a><a id="215" class="Symbol">;</a> <a id="217" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">_âˆ·_</a><a id="220" class="Symbol">;</a> <a id="222" href="Data.List.Base.html#1556" class="Function Operator">_++_</a><a id="226" class="Symbol">)</a>
<a id="228" class="Keyword">open</a> <a id="233" class="Keyword">import</a> <a id="240" href="Data.String.html" class="Module">Data.String</a> <a id="252" class="Keyword">using</a> <a id="258" class="Symbol">(</a><a id="259" href="Agda.Builtin.String.html#206" class="Postulate">String</a><a id="265" class="Symbol">)</a>
<a id="267" class="Keyword">open</a> <a id="272" class="Keyword">import</a> <a id="279" href="Category.Monad.html" class="Module">Category.Monad</a>
<a id="294" class="Keyword">open</a> <a id="299" class="Keyword">import</a> <a id="306" href="Category.Monad.State.html" class="Module">Category.Monad.State</a>
<a id="327" class="Keyword">open</a> <a id="332" class="Keyword">import</a> <a id="339" href="Function.html" class="Module">Function</a>
<a id="348" class="Keyword">open</a> <a id="353" class="Keyword">import</a> <a id="360" href="Relation.Unary.html" class="Module">Relation.Unary</a>

<a id="376" class="Comment">-- We reuse Name, Printer, M, fresh, and names from the STLC printing example</a>

<a id="455" class="Keyword">open</a> <a id="460" class="Keyword">import</a> <a id="467" href="StateOfTheArt.ACMM.html" class="Module">StateOfTheArt.ACMM</a> <a id="486" class="Keyword">using</a> <a id="492" class="Symbol">(</a><a id="493" class="Keyword">module</a> <a id="500" href="StateOfTheArt.ACMM.html#3504" class="Module">Printer</a><a id="507" class="Symbol">)</a>
<a id="509" class="Keyword">open</a> <a id="514" href="StateOfTheArt.ACMM.html#3504" class="Module">Printer</a> <a id="522" class="Keyword">using</a> <a id="528" class="Symbol">(</a><a id="529" href="StateOfTheArt.ACMM.html#3645" class="Function">M</a><a id="530" class="Symbol">;</a> <a id="532" href="StateOfTheArt.ACMM.html#3697" class="Record">Wrap</a><a id="536" class="Symbol">;</a> <a id="538" href="StateOfTheArt.ACMM.html#3801" class="Function">Name</a><a id="542" class="Symbol">;</a> <a id="544" href="StateOfTheArt.ACMM.html#3840" class="Function">Printer</a><a id="551" class="Symbol">;</a> <a id="553" href="StateOfTheArt.ACMM.html#3760" class="InductiveConstructor">MkW</a><a id="556" class="Symbol">;</a> <a id="558" href="StateOfTheArt.ACMM.html#3771" class="Field">getW</a><a id="562" class="Symbol">;</a> <a id="564" href="StateOfTheArt.ACMM.html#3955" class="Function">map^Wrap</a><a id="572" class="Symbol">;</a> <a id="574" href="StateOfTheArt.ACMM.html#3890" class="Function">th^Wrap</a><a id="581" class="Symbol">;</a> <a id="583" href="StateOfTheArt.ACMM.html#4058" class="Function">fresh</a><a id="588" class="Symbol">;</a> <a id="590" href="StateOfTheArt.ACMM.html#4911" class="Function">names</a><a id="595" class="Symbol">)</a>

<a id="598" class="Keyword">private</a>
  <a id="608" class="Keyword">variable</a>
    <a id="621" href="Generic.Semantics.Printing.html#621" class="Generalizable">Î“</a> <a id="623" href="Generic.Semantics.Printing.html#623" class="Generalizable">Î”</a> <a id="625" class="Symbol">:</a> <a id="627" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="632" href="Generic.Semantics.Printing.html#74" class="Bound">I</a>
    <a id="638" href="Generic.Semantics.Printing.html#638" class="Generalizable">Ïƒ</a> <a id="640" class="Symbol">:</a> <a id="642" href="Generic.Semantics.Printing.html#74" class="Bound">I</a>
    <a id="648" href="Generic.Semantics.Printing.html#648" class="Generalizable">i</a> <a id="650" class="Symbol">:</a> <a id="652" href="Agda.Builtin.Size.html#179" class="Postulate">Size</a>

<a id="658" class="Comment">-- The Printing Monad we are working with: a state containing a stream</a>
<a id="729" class="Comment">-- of *distinct* Strings.</a>
<a id="755" class="Keyword">module</a> <a id="ST"></a><a id="762" href="Generic.Semantics.Printing.html#762" class="Module">ST</a> <a id="765" class="Symbol">=</a> <a id="767" href="Category.Monad.State.html#3607" class="Module">RawMonadState</a> <a id="781" class="Symbol">(</a><a id="782" href="Category.Monad.State.html#4574" class="Function">StateMonadState</a> <a id="798" class="Symbol">(</a><a id="799" href="Codata.Stream.html#695" class="Datatype">Stream</a> <a id="806" href="Agda.Builtin.String.html#206" class="Postulate">String</a> <a id="813" class="Symbol">_))</a>
<a id="817" class="Keyword">open</a> <a id="822" href="Generic.Semantics.Printing.html#762" class="Module">ST</a> <a id="825" class="Keyword">renaming</a> <a id="834" class="Symbol">(</a><a id="835" href="Category.Monad.Indexed.html#1140" class="Function">rawIApplicative</a> <a id="851" class="Symbol">to</a> <a id="854" href="Category.Monad.Indexed.html#1140" class="Function">ApplicativeM</a><a id="866" class="Symbol">)</a>
        <a id="876" class="Keyword">hiding</a> <a id="883" class="Symbol">(</a><a id="884" href="Category.Functor.html#528" class="Function Operator">_&lt;$&gt;_</a><a id="889" class="Symbol">)</a>

<a id="892" class="Keyword">open</a> <a id="897" class="Keyword">import</a> <a id="904" href="Data.Var.html" class="Module">Data.Var</a> <a id="913" class="Keyword">hiding</a> <a id="920" class="Symbol">(</a><a id="921" href="Data.Var.html#801" class="Function">get</a><a id="924" class="Symbol">;</a> <a id="926" href="Data.Var.html#912" class="Function Operator">_&lt;$&gt;_</a><a id="931" class="Symbol">)</a>
<a id="933" class="Keyword">open</a> <a id="938" class="Keyword">import</a> <a id="945" href="Data.Environment.html" class="Module">Data.Environment</a> <a id="962" class="Keyword">hiding</a> <a id="969" class="Symbol">(</a><a id="970" href="Data.Environment.html#1553" class="Function Operator">_&gt;&gt;_</a><a id="974" class="Symbol">;</a> <a id="976" href="Data.Environment.html#4413" class="Function">sequenceA</a><a id="985" class="Symbol">;</a> <a id="987" href="Data.Environment.html#726" class="Function Operator">_&lt;$&gt;_</a><a id="992" class="Symbol">)</a>
<a id="994" class="Keyword">open</a> <a id="999" class="Keyword">import</a> <a id="1006" href="Data.Var.Varlike.html" class="Module">Data.Var.Varlike</a>
<a id="1023" class="Keyword">open</a> <a id="1028" class="Keyword">import</a> <a id="1035" href="Generic.Syntax.html" class="Module">Generic.Syntax</a> <a id="1050" class="Keyword">hiding</a> <a id="1057" class="Symbol">(</a><a id="1058" href="Generic.Syntax.html#4600" class="Function">sequenceA</a><a id="1067" class="Symbol">)</a>
<a id="1069" class="Keyword">open</a> <a id="1074" class="Keyword">import</a> <a id="1081" href="Generic.Semantics.html" class="Module">Generic.Semantics</a>


<a id="vl^MName"></a><a id="1101" href="Generic.Semantics.Printing.html#1101" class="Function">vl^MName</a> <a id="1110" class="Symbol">:</a> <a id="1112" href="Data.Var.Varlike.html#512" class="Record">VarLike</a> <a id="1120" class="Symbol">{</a><a id="1121" href="Generic.Semantics.Printing.html#74" class="Bound">I</a><a id="1122" class="Symbol">}</a> <a id="1124" class="Symbol">(Î»</a> <a id="1127" href="Generic.Semantics.Printing.html#1127" class="Bound">Ïƒ</a> <a id="1129" class="Symbol">â†’</a> <a id="1131" href="StateOfTheArt.ACMM.html#3645" class="Function">M</a> <a id="1133" href="Function.html#805" class="Function Operator">âˆ˜</a> <a id="1135" class="Symbol">(</a><a id="1136" href="StateOfTheArt.ACMM.html#3801" class="Function">Name</a> <a id="1141" href="Generic.Semantics.Printing.html#1127" class="Bound">Ïƒ</a><a id="1142" class="Symbol">))</a>
<a id="1145" href="Generic.Semantics.Printing.html#1101" class="Function">vl^MName</a> <a id="1154" class="Symbol">=</a> <a id="1156" class="Keyword">record</a>
  <a id="1165" class="Symbol">{</a> <a id="1167" href="Data.Var.Varlike.html#557" class="Field">th^ğ“¥</a>  <a id="1173" class="Symbol">=</a> <a id="1175" href="Data.Environment.html#3761" class="Function">th^Functor</a> <a id="1186" href="Category.Applicative.Indexed.html#998" class="Function">functor^M</a> <a id="1196" href="StateOfTheArt.ACMM.html#3890" class="Function">th^Wrap</a>
  <a id="1206" class="Symbol">;</a> <a id="1208" href="Data.Var.Varlike.html#590" class="Field">new</a>   <a id="1214" class="Symbol">=</a> <a id="1216" href="StateOfTheArt.ACMM.html#4058" class="Function">fresh</a> <a id="1222" class="Symbol">_</a>
  <a id="1226" class="Symbol">}</a>

    <a id="1233" class="Keyword">where</a> <a id="1239" class="Keyword">open</a> <a id="1244" href="Generic.Semantics.Printing.html#762" class="Module">ST</a> <a id="1247" class="Keyword">renaming</a> <a id="1256" class="Symbol">(</a><a id="1257" href="Category.Applicative.Indexed.html#998" class="Function">rawFunctor</a> <a id="1268" class="Symbol">to</a> <a id="1271" href="Category.Applicative.Indexed.html#998" class="Function">functor^M</a><a id="1280" class="Symbol">)</a>

<a id="1283" class="Comment">-- To print a term the user need to explain to us how to display one</a>
<a id="1352" class="Comment">-- layer of term given that the newly-bound variables have been assigned</a>
<a id="1425" class="Comment">-- fresh names and the subterms have already been rendered using these</a>
<a id="1496" class="Comment">-- names.</a>


<a id="Pieces"></a><a id="1508" href="Generic.Semantics.Printing.html#1508" class="Function">Pieces</a> <a id="1515" class="Symbol">:</a> <a id="1517" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="1522" href="Generic.Semantics.Printing.html#74" class="Bound">I</a> <a id="1524" class="Symbol">â†’</a> <a id="1526" href="Generic.Semantics.Printing.html#74" class="Bound">I</a> <a id="1528" href="Data.Var.html#511" class="Function Operator">â”€Scoped</a>
<a id="1536" href="Generic.Semantics.Printing.html#1508" class="Function">Pieces</a> <a id="1543" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>  <a id="1547" href="Generic.Semantics.Printing.html#1547" class="Bound">i</a> <a id="1549" href="Generic.Semantics.Printing.html#1549" class="Bound">Î“</a> <a id="1551" class="Symbol">=</a> <a id="1553" href="Agda.Builtin.String.html#206" class="Postulate">String</a>
<a id="1560" href="Generic.Semantics.Printing.html#1508" class="CatchallClause Function">Pieces</a><a id="1566" class="CatchallClause"> </a><a id="1567" href="Generic.Semantics.Printing.html#1567" class="CatchallClause Bound">Î”</a><a id="1568" class="CatchallClause">   </a><a id="1571" href="Generic.Semantics.Printing.html#1571" class="CatchallClause Bound">i</a><a id="1572" class="CatchallClause"> </a><a id="1573" href="Generic.Semantics.Printing.html#1573" class="CatchallClause Bound">Î“</a> <a id="1575" class="Symbol">=</a> <a id="1577" class="Symbol">(</a><a id="1578" href="Generic.Semantics.Printing.html#1567" class="Bound">Î”</a> <a id="1580" href="Data.Environment.html#496" class="Record Operator">â”€Env</a><a id="1584" class="Symbol">)</a> <a id="1586" href="StateOfTheArt.ACMM.html#3801" class="Function">Name</a> <a id="1591" class="Symbol">(</a><a id="1592" href="Generic.Semantics.Printing.html#1567" class="Bound">Î”</a> <a id="1594" href="Data.List.Base.html#1556" class="Function Operator">++</a> <a id="1597" href="Generic.Semantics.Printing.html#1573" class="Bound">Î“</a><a id="1598" class="Symbol">)</a> <a id="1600" href="Data.Product.html#1389" class="Function Operator">Ã—</a> <a id="1602" href="Agda.Builtin.String.html#206" class="Postulate">String</a>

<a id="reify^M"></a><a id="1610" href="Generic.Semantics.Printing.html#1610" class="Function">reify^M</a> <a id="1618" class="Symbol">:</a> <a id="1620" class="Symbol">âˆ€</a> <a id="1622" href="Generic.Semantics.Printing.html#1622" class="Bound">Î”</a> <a id="1624" href="Generic.Semantics.Printing.html#1624" class="Bound">i</a> <a id="1626" class="Symbol">â†’</a> <a id="1628" href="Data.Environment.html#3905" class="Function">Kripke</a> <a id="1635" href="StateOfTheArt.ACMM.html#3801" class="Function">Name</a> <a id="1640" href="StateOfTheArt.ACMM.html#3840" class="Function">Printer</a> <a id="1648" href="Generic.Semantics.Printing.html#1622" class="Bound">Î”</a> <a id="1650" href="Generic.Semantics.Printing.html#1624" class="Bound">i</a> <a id="1652" href="Generic.Semantics.Printing.html#621" class="Generalizable">Î“</a> <a id="1654" class="Symbol">â†’</a> <a id="1656" href="StateOfTheArt.ACMM.html#3645" class="Function">M</a> <a id="1658" class="Symbol">(</a><a id="1659" href="Generic.Semantics.Printing.html#1508" class="Function">Pieces</a> <a id="1666" href="Generic.Semantics.Printing.html#1622" class="Bound">Î”</a> <a id="1668" href="Generic.Semantics.Printing.html#1624" class="Bound">i</a> <a id="1670" href="Generic.Semantics.Printing.html#621" class="Generalizable">Î“</a><a id="1671" class="Symbol">)</a>

<a id="1674" href="Generic.Semantics.Printing.html#1610" class="Function">reify^M</a> <a id="1682" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>         <a id="1693" href="Generic.Semantics.Printing.html#1693" class="Bound">i</a> <a id="1695" href="Generic.Semantics.Printing.html#1695" class="Bound">p</a>  <a id="1698" class="Symbol">=</a> <a id="1700" href="StateOfTheArt.ACMM.html#3771" class="Field">getW</a> <a id="1705" href="Generic.Semantics.Printing.html#1695" class="Bound">p</a>

<a id="1708" href="Generic.Semantics.Printing.html#1610" class="Function">reify^M</a> <a id="1716" href="Generic.Semantics.Printing.html#1716" class="Bound">Î”</a><a id="1717" class="Symbol">@(_</a> <a id="1721" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">âˆ·</a> <a id="1723" class="Symbol">_)</a>  <a id="1727" href="Generic.Semantics.Printing.html#1727" class="Bound">i</a> <a id="1729" href="Generic.Semantics.Printing.html#1729" class="Bound">f</a>  <a id="1732" class="Symbol">=</a> <a id="1734" class="Keyword">do</a>
  <a id="1739" href="Generic.Semantics.Printing.html#1739" class="Bound">Ï</a> <a id="1741" href="Category.Monad.Indexed.html#604" class="Function Operator">â†</a> <a id="1743" href="Data.Environment.html#4413" class="Function">sequenceA</a> <a id="1753" class="Symbol">(</a><a id="1754" href="Data.Var.Varlike.html#813" class="Function">freshË¡</a> <a id="1761" href="Generic.Semantics.Printing.html#1101" class="Function">vl^MName</a> <a id="1770" class="Symbol">_)</a>
  <a id="1775" href="Generic.Semantics.Printing.html#1775" class="Bound">b</a> <a id="1777" href="Category.Monad.Indexed.html#604" class="Function Operator">â†</a> <a id="1779" href="StateOfTheArt.ACMM.html#3771" class="Field">getW</a> <a id="1784" class="Symbol">(</a><a id="1785" href="Generic.Semantics.Printing.html#1729" class="Bound">f</a> <a id="1787" class="Symbol">(</a><a id="1788" href="Data.Var.Varlike.html#717" class="Function">freshÊ³</a> <a id="1795" href="Data.Var.Varlike.html#992" class="Function">vl^Var</a> <a id="1802" href="Generic.Semantics.Printing.html#1716" class="Bound">Î”</a><a id="1803" class="Symbol">)</a> <a id="1805" href="Generic.Semantics.Printing.html#1739" class="Bound">Ï</a><a id="1806" class="Symbol">)</a>
  <a id="1810" href="Category.Monad.Indexed.html#569" class="Function">return</a> <a id="1817" class="Symbol">(</a><a id="1818" href="Generic.Semantics.Printing.html#1739" class="Bound">Ï</a> <a id="1820" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1822" href="Generic.Semantics.Printing.html#1775" class="Bound">b</a><a id="1823" class="Symbol">)</a>

  <a id="1828" class="Keyword">where</a> <a id="1834" class="Keyword">open</a> <a id="1839" href="Data.Environment.html" class="Module">Data.Environment</a>
        <a id="1864" class="Keyword">instance</a> <a id="1873" href="Generic.Semantics.Printing.html#1873" class="Function">_</a> <a id="1875" class="Symbol">=</a> <a id="1877" href="Category.Monad.Indexed.html#1140" class="Function">ApplicativeM</a>


<a id="Display"></a><a id="1892" href="Generic.Semantics.Printing.html#1892" class="Function">Display</a> <a id="1900" class="Symbol">:</a> <a id="1902" href="Generic.Syntax.html#503" class="Datatype">Desc</a> <a id="1907" href="Generic.Semantics.Printing.html#74" class="Bound">I</a> <a id="1909" class="Symbol">â†’</a> <a id="1911" class="PrimitiveType">Set</a>
<a id="1915" href="Generic.Semantics.Printing.html#1892" class="Function">Display</a> <a id="1923" href="Generic.Semantics.Printing.html#1923" class="Bound">d</a> <a id="1925" class="Symbol">=</a> <a id="1927" class="Symbol">âˆ€</a> <a id="1929" class="Symbol">{</a><a id="1930" href="Generic.Semantics.Printing.html#1930" class="Bound">i</a> <a id="1932" href="Generic.Semantics.Printing.html#1932" class="Bound">Î“</a><a id="1933" class="Symbol">}</a> <a id="1935" class="Symbol">â†’</a> <a id="1937" href="Generic.Syntax.html#954" class="Function Operator">âŸ¦</a> <a id="1939" href="Generic.Semantics.Printing.html#1923" class="Bound">d</a> <a id="1941" href="Generic.Syntax.html#954" class="Function Operator">âŸ§</a> <a id="1943" href="Generic.Semantics.Printing.html#1508" class="Function">Pieces</a> <a id="1950" href="Generic.Semantics.Printing.html#1930" class="Bound">i</a> <a id="1952" href="Generic.Semantics.Printing.html#1932" class="Bound">Î“</a> <a id="1954" class="Symbol">â†’</a> <a id="1956" href="Agda.Builtin.String.html#206" class="Postulate">String</a>


<a id="1965" class="Comment">---------------------------------------------------------------------</a>
<a id="2035" class="Comment">-- Generic Printing Semantics</a>

<a id="2066" class="Comment">-- Given a strategy to `Display` one layer of term we can generate a full</a>
<a id="2140" class="Comment">-- printer.</a>

<a id="2153" class="Keyword">open</a> <a id="2158" href="Generic.Semantics.html#780" class="Module">Semantics</a>

<a id="2169" class="Keyword">module</a> <a id="2176" href="Generic.Semantics.Printing.html#2176" class="Module">_</a> <a id="2178" class="Symbol">{</a><a id="2179" href="Generic.Semantics.Printing.html#2179" class="Bound">d</a> <a id="2181" class="Symbol">:</a> <a id="2183" href="Generic.Syntax.html#503" class="Datatype">Desc</a> <a id="2188" href="Generic.Semantics.Printing.html#74" class="Bound">I</a><a id="2189" class="Symbol">}</a> <a id="2191" class="Keyword">where</a>


  <a id="2201" href="Generic.Semantics.Printing.html#2201" class="Function">Printing</a> <a id="2210" class="Symbol">:</a> <a id="2212" href="Generic.Semantics.Printing.html#1892" class="Function">Display</a> <a id="2220" href="Generic.Semantics.Printing.html#2179" class="Bound">d</a> <a id="2222" class="Symbol">â†’</a> <a id="2224" href="Generic.Semantics.html#780" class="Record">Semantics</a> <a id="2234" href="Generic.Semantics.Printing.html#2179" class="Bound">d</a> <a id="2236" href="StateOfTheArt.ACMM.html#3801" class="Function">Name</a> <a id="2241" href="StateOfTheArt.ACMM.html#3840" class="Function">Printer</a>
  <a id="2251" href="Generic.Semantics.Printing.html#2201" class="Function">Printing</a> <a id="2260" href="Generic.Semantics.Printing.html#2260" class="Bound">dis</a> <a id="2264" class="Symbol">.</a><a id="2265" href="Generic.Semantics.html#845" class="Field">th^ğ“¥</a>  <a id="2271" class="Symbol">=</a> <a id="2273" href="StateOfTheArt.ACMM.html#3890" class="Function">th^Wrap</a>
  <a id="2283" href="Generic.Semantics.Printing.html#2201" class="Function">Printing</a> <a id="2292" href="Generic.Semantics.Printing.html#2292" class="Bound">dis</a> <a id="2296" class="Symbol">.</a><a id="2297" href="Generic.Semantics.html#872" class="Field">var</a>   <a id="2303" class="Symbol">=</a> <a id="2305" href="StateOfTheArt.ACMM.html#3955" class="Function">map^Wrap</a> <a id="2314" href="Category.Monad.Indexed.html#569" class="Function">return</a>
  <a id="2323" href="Generic.Semantics.Printing.html#2201" class="Function">Printing</a> <a id="2332" href="Generic.Semantics.Printing.html#2332" class="Bound">dis</a> <a id="2336" class="Symbol">.</a><a id="2337" href="Generic.Semantics.html#897" class="Field">alg</a>   <a id="2343" class="Symbol">=</a> <a id="2345" class="Symbol">Î»</a> <a id="2347" href="Generic.Semantics.Printing.html#2347" class="Bound">v</a> <a id="2349" class="Symbol">â†’</a> <a id="2351" href="StateOfTheArt.ACMM.html#3760" class="InductiveConstructor">MkW</a> <a id="2355" href="Function.html#1927" class="Function Operator">$</a> <a id="2357" href="Generic.Semantics.Printing.html#2332" class="Bound">dis</a> <a id="2361" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;</a> <a id="2365" href="Generic.Syntax.html#4870" class="Function">mapA</a> <a id="2370" href="Generic.Semantics.Printing.html#2179" class="Bound">d</a> <a id="2372" href="Generic.Semantics.Printing.html#1610" class="Function">reify^M</a> <a id="2380" href="Generic.Semantics.Printing.html#2347" class="Bound">v</a>

    <a id="2387" class="Keyword">where</a> <a id="2393" class="Keyword">open</a> <a id="2398" href="Generic.Syntax.html" class="Module">Generic.Syntax</a>
          <a id="2423" class="Keyword">open</a> <a id="2428" href="Generic.Semantics.Printing.html#762" class="Module">ST</a>
          <a id="2441" class="Keyword">instance</a> <a id="2450" href="Generic.Semantics.Printing.html#2450" class="Function">_</a> <a id="2452" class="Symbol">=</a> <a id="2454" href="Category.Monad.Indexed.html#1140" class="Function">ApplicativeM</a>

<a id="2468" class="Comment">-- Corollary: a generic printer using a silly name supply</a>


  <a id="2530" class="Keyword">open</a> <a id="2535" href="Data.Environment.html" class="Module">Data.Environment</a>
  <a id="2554" class="Keyword">instance</a> <a id="2563" href="Generic.Semantics.Printing.html#2563" class="Function">_</a> <a id="2565" class="Symbol">=</a> <a id="2567" href="Category.Monad.Indexed.html#1140" class="Function">ApplicativeM</a>


  <a id="2584" href="Generic.Semantics.Printing.html#2584" class="Function">print</a> <a id="2590" class="Symbol">:</a> <a id="2592" href="Generic.Semantics.Printing.html#1892" class="Function">Display</a> <a id="2600" href="Generic.Semantics.Printing.html#2179" class="Bound">d</a> <a id="2602" class="Symbol">â†’</a> <a id="2604" href="Generic.Syntax.html#1293" class="Datatype">Tm</a> <a id="2607" href="Generic.Semantics.Printing.html#2179" class="Bound">d</a> <a id="2609" href="Generic.Semantics.Printing.html#648" class="Generalizable">i</a> <a id="2611" href="Generic.Semantics.Printing.html#638" class="Generalizable">Ïƒ</a> <a id="2613" href="Generic.Semantics.Printing.html#621" class="Generalizable">Î“</a> <a id="2615" class="Symbol">â†’</a> <a id="2617" href="Agda.Builtin.String.html#206" class="Postulate">String</a>

  <a id="2627" href="Generic.Semantics.Printing.html#2584" class="Function">print</a> <a id="2633" href="Generic.Semantics.Printing.html#2633" class="Bound">dis</a> <a id="2637" href="Generic.Semantics.Printing.html#2637" class="Bound">t</a> <a id="2639" class="Symbol">=</a> <a id="2641" href="Agda.Builtin.Sigma.html#225" class="Field">projâ‚</a> <a id="2647" class="Symbol">(</a><a id="2648" href="Generic.Semantics.Printing.html#2673" class="Function">printer</a> <a id="2656" href="StateOfTheArt.ACMM.html#4911" class="Function">names</a><a id="2661" class="Symbol">)</a> <a id="2663" class="Keyword">where</a>
    <a id="2673" href="Generic.Semantics.Printing.html#2673" class="Function">printer</a> <a id="2681" class="Symbol">:</a> <a id="2683" href="StateOfTheArt.ACMM.html#3645" class="Function">M</a> <a id="2685" href="Agda.Builtin.String.html#206" class="Postulate">String</a>
    <a id="2696" href="Generic.Semantics.Printing.html#2673" class="Function">printer</a> <a id="2704" class="Symbol">=</a> <a id="2706" class="Keyword">do</a>
      <a id="2715" href="Generic.Semantics.Printing.html#2715" class="Bound">init</a> <a id="2720" href="Category.Monad.Indexed.html#604" class="Function Operator">â†</a> <a id="2722" href="Data.Environment.html#4413" class="Function">sequenceA</a> <a id="2732" class="Symbol">(</a><a id="2733" href="Data.Var.Varlike.html#620" class="Function">base</a> <a id="2738" href="Generic.Semantics.Printing.html#1101" class="Function">vl^MName</a><a id="2746" class="Symbol">)</a>
      <a id="2754" href="StateOfTheArt.ACMM.html#3771" class="Field">getW</a> <a id="2759" class="Symbol">(</a><a id="2760" href="Generic.Semantics.html#937" class="Function">Semantics.semantics</a> <a id="2780" class="Symbol">(</a><a id="2781" href="Generic.Semantics.Printing.html#2201" class="Function">Printing</a> <a id="2790" href="Generic.Semantics.Printing.html#2633" class="Bound">dis</a><a id="2793" class="Symbol">)</a> <a id="2795" href="Generic.Semantics.Printing.html#2715" class="Bound">init</a> <a id="2800" href="Generic.Semantics.Printing.html#2637" class="Bound">t</a><a id="2801" class="Symbol">)</a>

</pre></body></html>