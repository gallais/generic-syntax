<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Generic.Semantics.Printing</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Pragma">--sized-types</a> <a id="34" class="Symbol">#-}</a>

<a id="39" class="Keyword">module</a> <a id="46" href="Generic.Semantics.Printing.html" class="Module">Generic.Semantics.Printing</a> <a id="73" class="Symbol">{</a><a id="74" href="Generic.Semantics.Printing.html#74" class="Bound">I</a> <a id="76" class="Symbol">:</a> <a id="78" class="PrimitiveType">Set</a><a id="81" class="Symbol">}</a> <a id="83" class="Keyword">where</a>

<a id="90" class="Keyword">open</a> <a id="95" class="Keyword">import</a> <a id="102" href="Codata.Stream.html" class="Module">Codata.Stream</a> <a id="116" class="Keyword">using</a> <a id="122" class="Symbol">(</a><a id="123" href="Codata.Stream.html#705" class="Datatype">Stream</a><a id="129" class="Symbol">)</a>
<a id="131" class="Keyword">open</a> <a id="136" class="Keyword">import</a> <a id="143" href="Size.html" class="Module">Size</a>
<a id="148" class="Keyword">open</a> <a id="153" class="Keyword">import</a> <a id="160" href="Data.Product.html" class="Module">Data.Product</a>
<a id="173" class="Keyword">open</a> <a id="178" class="Keyword">import</a> <a id="185" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="200" class="Keyword">using</a> <a id="206" class="Symbol">(</a><a id="207" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="211" class="Symbol">;</a> <a id="213" href="Data.List.Base.html#10010" class="InductiveConstructor">[]</a><a id="215" class="Symbol">;</a> <a id="217" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_âˆ·_</a><a id="220" class="Symbol">;</a> <a id="222" href="Data.List.Base.html#1763" class="Function Operator">_++_</a><a id="226" class="Symbol">)</a>
<a id="228" class="Keyword">open</a> <a id="233" class="Keyword">import</a> <a id="240" href="Data.String.html" class="Module">Data.String</a> <a id="252" class="Keyword">using</a> <a id="258" class="Symbol">(</a><a id="259" href="Agda.Builtin.String.html#274" class="Postulate">String</a><a id="265" class="Symbol">)</a>
<a id="267" class="Keyword">open</a> <a id="272" class="Keyword">import</a> <a id="279" href="Category.Monad.html" class="Module">Category.Monad</a>
<a id="294" class="Keyword">open</a> <a id="299" class="Keyword">import</a> <a id="306" href="Category.Monad.State.html" class="Module">Category.Monad.State</a>
<a id="327" class="Keyword">open</a> <a id="332" class="Keyword">import</a> <a id="339" href="Function.html" class="Module">Function</a>
<a id="348" class="Keyword">open</a> <a id="353" class="Keyword">import</a> <a id="360" href="Relation.Unary.html" class="Module">Relation.Unary</a>

<a id="376" class="Comment">-- We reuse Name, Printer, M, fresh, and names from the STLC printing example</a>

<a id="455" class="Keyword">open</a> <a id="460" class="Keyword">import</a> <a id="467" href="StateOfTheArt.ACMM.html" class="Module">StateOfTheArt.ACMM</a> <a id="486" class="Keyword">using</a> <a id="492" class="Symbol">(</a><a id="493" class="Keyword">module</a> <a id="500" href="StateOfTheArt.ACMM.html#3523" class="Module">Printer</a><a id="507" class="Symbol">)</a>
<a id="509" class="Keyword">open</a> <a id="514" href="StateOfTheArt.ACMM.html#3523" class="Module">Printer</a> <a id="522" class="Keyword">using</a> <a id="528" class="Symbol">(</a><a id="529" href="StateOfTheArt.ACMM.html#3664" class="Function">Fresh</a><a id="534" class="Symbol">;</a> <a id="536" href="StateOfTheArt.ACMM.html#3724" class="Record">Wrap</a><a id="540" class="Symbol">;</a> <a id="542" href="StateOfTheArt.ACMM.html#3828" class="Function">Name</a><a id="546" class="Symbol">;</a> <a id="548" href="StateOfTheArt.ACMM.html#3867" class="Function">Printer</a><a id="555" class="Symbol">;</a> <a id="557" href="StateOfTheArt.ACMM.html#3787" class="InductiveConstructor">MkW</a><a id="560" class="Symbol">;</a> <a id="562" href="StateOfTheArt.ACMM.html#3798" class="Field">getW</a><a id="566" class="Symbol">;</a> <a id="568" href="StateOfTheArt.ACMM.html#3986" class="Function">map^Wrap</a><a id="576" class="Symbol">;</a> <a id="578" href="StateOfTheArt.ACMM.html#3921" class="Function">th^Wrap</a><a id="585" class="Symbol">;</a> <a id="587" href="StateOfTheArt.ACMM.html#4089" class="Function">fresh</a><a id="592" class="Symbol">;</a> <a id="594" href="StateOfTheArt.ACMM.html#5074" class="Function">names</a><a id="599" class="Symbol">)</a>

<a id="602" class="Keyword">private</a>
  <a id="612" class="Keyword">variable</a>
    <a id="625" href="Generic.Semantics.Printing.html#625" class="Generalizable">Î“</a> <a id="627" href="Generic.Semantics.Printing.html#627" class="Generalizable">Î”</a> <a id="629" class="Symbol">:</a> <a id="631" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="636" href="Generic.Semantics.Printing.html#74" class="Bound">I</a>
    <a id="642" href="Generic.Semantics.Printing.html#642" class="Generalizable">Ïƒ</a> <a id="644" class="Symbol">:</a> <a id="646" href="Generic.Semantics.Printing.html#74" class="Bound">I</a>
    <a id="652" href="Generic.Semantics.Printing.html#652" class="Generalizable">i</a> <a id="654" class="Symbol">:</a> <a id="656" href="Agda.Builtin.Size.html#206" class="Postulate">Size</a>

<a id="662" class="Comment">-- The Printing Monad we are working with: a state containing a stream</a>
<a id="733" class="Comment">-- of *distinct* Strings.</a>
<a id="759" class="Keyword">module</a> <a id="ST"></a><a id="766" href="Generic.Semantics.Printing.html#766" class="Module">ST</a> <a id="769" class="Symbol">=</a> <a id="771" href="Category.Monad.State.html#3504" class="Module">RawMonadState</a> <a id="785" class="Symbol">(</a><a id="786" href="Category.Monad.State.html#4429" class="Function">StateMonadState</a> <a id="802" class="Symbol">(</a><a id="803" href="Codata.Stream.html#705" class="Datatype">Stream</a> <a id="810" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="817" class="Symbol">_))</a>
<a id="821" class="Keyword">open</a> <a id="826" href="Generic.Semantics.Printing.html#766" class="Module">ST</a> <a id="829" class="Keyword">renaming</a> <a id="838" class="Symbol">(</a><a id="839" href="Category.Monad.Indexed.html#1141" class="Function">rawIApplicative</a> <a id="855" class="Symbol">to</a> <a id="ST.rawIApplicative"></a><a id="858" href="Generic.Semantics.Printing.html#858" class="Function">ApplicativeM</a><a id="870" class="Symbol">)</a>
        <a id="880" class="Keyword">hiding</a> <a id="887" class="Symbol">(</a><a id="888" href="Category.Functor.html#608" class="Function Operator">_&lt;$&gt;_</a><a id="893" class="Symbol">)</a>

<a id="896" class="Keyword">open</a> <a id="901" class="Keyword">import</a> <a id="908" href="Data.Var.html" class="Module">Data.Var</a> <a id="917" class="Keyword">hiding</a> <a id="924" class="Symbol">(</a><a id="925" href="Data.Var.html#821" class="Function">get</a><a id="928" class="Symbol">;</a> <a id="930" href="Data.Var.html#932" class="Function Operator">_&lt;$&gt;_</a><a id="935" class="Symbol">)</a>
<a id="937" class="Keyword">open</a> <a id="942" class="Keyword">import</a> <a id="949" href="Data.Environment.html" class="Module">Data.Environment</a> <a id="966" class="Keyword">hiding</a> <a id="973" class="Symbol">(</a><a id="974" href="Data.Environment.html#1622" class="Function Operator">_&gt;&gt;_</a><a id="978" class="Symbol">;</a> <a id="980" href="Data.Environment.html#5773" class="Function">sequenceA</a><a id="989" class="Symbol">;</a> <a id="991" href="Data.Environment.html#794" class="Function Operator">_&lt;$&gt;_</a><a id="996" class="Symbol">)</a>
<a id="998" class="Keyword">open</a> <a id="1003" class="Keyword">import</a> <a id="1010" href="Data.Var.Varlike.html" class="Module">Data.Var.Varlike</a>
<a id="1027" class="Keyword">open</a> <a id="1032" class="Keyword">import</a> <a id="1039" href="Generic.Syntax.html" class="Module">Generic.Syntax</a> <a id="1054" class="Keyword">hiding</a> <a id="1061" class="Symbol">(</a><a id="1062" href="Generic.Syntax.html#4624" class="Function">sequenceA</a><a id="1071" class="Symbol">)</a>
<a id="1073" class="Keyword">open</a> <a id="1078" class="Keyword">import</a> <a id="1085" href="Generic.Semantics.html" class="Module">Generic.Semantics</a>


<a id="vl^FreshName"></a><a id="1105" href="Generic.Semantics.Printing.html#1105" class="Function">vl^FreshName</a> <a id="1118" class="Symbol">:</a> <a id="1120" href="Data.Var.Varlike.html#512" class="Record">VarLike</a> <a id="1128" class="Symbol">(Î»</a> <a id="1131" class="Symbol">(</a><a id="1132" href="Generic.Semantics.Printing.html#1132" class="Bound">Ïƒ</a> <a id="1134" class="Symbol">:</a> <a id="1136" href="Generic.Semantics.Printing.html#74" class="Bound">I</a><a id="1137" class="Symbol">)</a> <a id="1139" class="Symbol">â†’</a> <a id="1141" href="StateOfTheArt.ACMM.html#3664" class="Function">Fresh</a> <a id="1147" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a> <a id="1149" class="Symbol">(</a><a id="1150" href="StateOfTheArt.ACMM.html#3828" class="Function">Name</a> <a id="1155" href="Generic.Semantics.Printing.html#1132" class="Bound">Ïƒ</a><a id="1156" class="Symbol">))</a>
<a id="1159" href="Generic.Semantics.Printing.html#1105" class="Function">vl^FreshName</a> <a id="1172" class="Symbol">=</a> <a id="1174" class="Keyword">record</a>
  <a id="1183" class="Symbol">{</a> <a id="1185" href="Data.Var.Varlike.html#557" class="Field">th^ğ“¥</a>  <a id="1191" class="Symbol">=</a> <a id="1193" href="Data.Environment.html#5121" class="Function">th^Functor</a> <a id="1204" href="Generic.Semantics.Printing.html#1289" class="Function">functor^M</a> <a id="1214" href="StateOfTheArt.ACMM.html#3921" class="Function">th^Wrap</a>
  <a id="1224" class="Symbol">;</a> <a id="1226" href="Data.Var.Varlike.html#590" class="Field">new</a>   <a id="1232" class="Symbol">=</a> <a id="1234" href="StateOfTheArt.ACMM.html#4089" class="Function">fresh</a> <a id="1240" class="Symbol">_</a>
  <a id="1244" class="Symbol">}</a>

    <a id="1251" class="Keyword">where</a> <a id="1257" class="Keyword">open</a> <a id="1262" href="Generic.Semantics.Printing.html#766" class="Module">ST</a> <a id="1265" class="Keyword">renaming</a> <a id="1274" class="Symbol">(</a><a id="1275" href="Category.Applicative.Indexed.html#1090" class="Function">rawFunctor</a> <a id="1286" class="Symbol">to</a> <a id="ST.rawFunctor"></a><a id="1289" href="Generic.Semantics.Printing.html#1289" class="Function">functor^M</a><a id="1298" class="Symbol">)</a>

<a id="1301" class="Comment">-- To print a term the user need to explain to us how to display one</a>
<a id="1370" class="Comment">-- layer of term given that the newly-bound variables have been assigned</a>
<a id="1443" class="Comment">-- fresh names and the subterms have already been rendered using these</a>
<a id="1514" class="Comment">-- names.</a>


<a id="Pieces"></a><a id="1526" href="Generic.Semantics.Printing.html#1526" class="Function">Pieces</a> <a id="1533" class="Symbol">:</a> <a id="1535" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1540" href="Generic.Semantics.Printing.html#74" class="Bound">I</a> <a id="1542" class="Symbol">â†’</a> <a id="1544" href="Generic.Semantics.Printing.html#74" class="Bound">I</a> <a id="1546" href="Data.Var.html#531" class="Function Operator">â”€Scoped</a>
<a id="1554" href="Generic.Semantics.Printing.html#1526" class="Function">Pieces</a> <a id="1561" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>  <a id="1565" href="Generic.Semantics.Printing.html#1565" class="Bound">i</a> <a id="1567" href="Generic.Semantics.Printing.html#1567" class="Bound">Î“</a> <a id="1569" class="Symbol">=</a> <a id="1571" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="1578" href="Generic.Semantics.Printing.html#1526" class="CatchallClause Function">Pieces</a><a id="1584" class="CatchallClause"> </a><a id="1585" href="Generic.Semantics.Printing.html#1585" class="CatchallClause Bound">Î”</a><a id="1586" class="CatchallClause">   </a><a id="1589" href="Generic.Semantics.Printing.html#1589" class="CatchallClause Bound">i</a><a id="1590" class="CatchallClause"> </a><a id="1591" href="Generic.Semantics.Printing.html#1591" class="CatchallClause Bound">Î“</a> <a id="1593" class="Symbol">=</a> <a id="1595" class="Symbol">(</a><a id="1596" href="Generic.Semantics.Printing.html#1585" class="Bound">Î”</a> <a id="1598" href="Data.Environment.html#566" class="Record Operator">â”€Env</a><a id="1602" class="Symbol">)</a> <a id="1604" href="StateOfTheArt.ACMM.html#3828" class="Function">Name</a> <a id="1609" class="Symbol">(</a><a id="1610" href="Generic.Semantics.Printing.html#1585" class="Bound">Î”</a> <a id="1612" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="1615" href="Generic.Semantics.Printing.html#1591" class="Bound">Î“</a><a id="1616" class="Symbol">)</a> <a id="1618" href="Data.Product.html#1167" class="Function Operator">Ã—</a> <a id="1620" href="Agda.Builtin.String.html#274" class="Postulate">String</a>

<a id="reify^Pieces"></a><a id="1628" href="Generic.Semantics.Printing.html#1628" class="Function">reify^Pieces</a> <a id="1641" class="Symbol">:</a> <a id="1643" class="Symbol">âˆ€</a> <a id="1645" href="Generic.Semantics.Printing.html#1645" class="Bound">Î”</a> <a id="1647" href="Generic.Semantics.Printing.html#1647" class="Bound">i</a> <a id="1649" class="Symbol">â†’</a> <a id="1651" href="Data.Environment.html#5265" class="Function">Kripke</a> <a id="1658" href="StateOfTheArt.ACMM.html#3828" class="Function">Name</a> <a id="1663" href="StateOfTheArt.ACMM.html#3867" class="Function">Printer</a> <a id="1671" href="Generic.Semantics.Printing.html#1645" class="Bound">Î”</a> <a id="1673" href="Generic.Semantics.Printing.html#1647" class="Bound">i</a> <a id="1675" href="Generic.Semantics.Printing.html#625" class="Generalizable">Î“</a> <a id="1677" class="Symbol">â†’</a> <a id="1679" href="StateOfTheArt.ACMM.html#3664" class="Function">Fresh</a> <a id="1685" class="Symbol">(</a><a id="1686" href="Generic.Semantics.Printing.html#1526" class="Function">Pieces</a> <a id="1693" href="Generic.Semantics.Printing.html#1645" class="Bound">Î”</a> <a id="1695" href="Generic.Semantics.Printing.html#1647" class="Bound">i</a> <a id="1697" href="Generic.Semantics.Printing.html#625" class="Generalizable">Î“</a><a id="1698" class="Symbol">)</a>

<a id="1701" href="Generic.Semantics.Printing.html#1628" class="Function">reify^Pieces</a> <a id="1714" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>         <a id="1725" href="Generic.Semantics.Printing.html#1725" class="Bound">i</a> <a id="1727" href="Generic.Semantics.Printing.html#1727" class="Bound">p</a>  <a id="1730" class="Symbol">=</a> <a id="1732" href="StateOfTheArt.ACMM.html#3798" class="Field">getW</a> <a id="1737" href="Generic.Semantics.Printing.html#1727" class="Bound">p</a>

<a id="1740" href="Generic.Semantics.Printing.html#1628" class="Function">reify^Pieces</a> <a id="1753" href="Generic.Semantics.Printing.html#1753" class="Bound">Î”</a><a id="1754" class="Symbol">@(_</a> <a id="1758" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">âˆ·</a> <a id="1760" class="Symbol">_)</a>  <a id="1764" href="Generic.Semantics.Printing.html#1764" class="Bound">i</a> <a id="1766" href="Generic.Semantics.Printing.html#1766" class="Bound">f</a>  <a id="1769" class="Symbol">=</a> <a id="1771" class="Keyword">do</a>
  <a id="1776" href="Generic.Semantics.Printing.html#1776" class="Bound">Ï</a> <a id="1778" href="Category.Monad.Indexed.html#677" class="Function Operator">â†</a> <a id="1780" href="Data.Environment.html#5773" class="Function">sequenceA</a> <a id="1790" class="Symbol">(</a><a id="1791" href="Data.Var.Varlike.html#813" class="Function">freshË¡</a> <a id="1798" href="Generic.Semantics.Printing.html#1105" class="Function">vl^FreshName</a> <a id="1811" class="Symbol">_)</a>
  <a id="1816" href="Generic.Semantics.Printing.html#1816" class="Bound">b</a> <a id="1818" href="Category.Monad.Indexed.html#677" class="Function Operator">â†</a> <a id="1820" href="StateOfTheArt.ACMM.html#3798" class="Field">getW</a> <a id="1825" class="Symbol">(</a><a id="1826" href="Generic.Semantics.Printing.html#1766" class="Bound">f</a> <a id="1828" class="Symbol">(</a><a id="1829" href="Data.Var.Varlike.html#717" class="Function">freshÊ³</a> <a id="1836" href="Data.Var.Varlike.html#992" class="Function">vl^Var</a> <a id="1843" href="Generic.Semantics.Printing.html#1753" class="Bound">Î”</a><a id="1844" class="Symbol">)</a> <a id="1846" href="Generic.Semantics.Printing.html#1776" class="Bound">Ï</a><a id="1847" class="Symbol">)</a>
  <a id="1851" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="1858" class="Symbol">(</a><a id="1859" href="Generic.Semantics.Printing.html#1776" class="Bound">Ï</a> <a id="1861" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1863" href="Generic.Semantics.Printing.html#1816" class="Bound">b</a><a id="1864" class="Symbol">)</a>

  <a id="1869" class="Keyword">where</a> <a id="1875" class="Keyword">open</a> <a id="1880" href="Data.Environment.html" class="Module">Data.Environment</a>
        <a id="1905" class="Keyword">instance</a> <a id="1914" href="Generic.Semantics.Printing.html#1914" class="Function">_</a> <a id="1916" class="Symbol">=</a> <a id="1918" href="Generic.Semantics.Printing.html#858" class="Function">ApplicativeM</a>


<a id="Display"></a><a id="1933" href="Generic.Semantics.Printing.html#1933" class="Function">Display</a> <a id="1941" class="Symbol">:</a> <a id="1943" href="Generic.Syntax.html#527" class="Datatype">Desc</a> <a id="1948" href="Generic.Semantics.Printing.html#74" class="Bound">I</a> <a id="1950" class="Symbol">â†’</a> <a id="1952" class="PrimitiveType">Set</a>
<a id="1956" href="Generic.Semantics.Printing.html#1933" class="Function">Display</a> <a id="1964" href="Generic.Semantics.Printing.html#1964" class="Bound">d</a> <a id="1966" class="Symbol">=</a> <a id="1968" class="Symbol">âˆ€</a> <a id="1970" class="Symbol">{</a><a id="1971" href="Generic.Semantics.Printing.html#1971" class="Bound">i</a> <a id="1973" href="Generic.Semantics.Printing.html#1973" class="Bound">Î“</a><a id="1974" class="Symbol">}</a> <a id="1976" class="Symbol">â†’</a> <a id="1978" href="Generic.Syntax.html#978" class="Function Operator">âŸ¦</a> <a id="1980" href="Generic.Semantics.Printing.html#1964" class="Bound">d</a> <a id="1982" href="Generic.Syntax.html#978" class="Function Operator">âŸ§</a> <a id="1984" href="Generic.Semantics.Printing.html#1526" class="Function">Pieces</a> <a id="1991" href="Generic.Semantics.Printing.html#1971" class="Bound">i</a> <a id="1993" href="Generic.Semantics.Printing.html#1973" class="Bound">Î“</a> <a id="1995" class="Symbol">â†’</a> <a id="1997" href="Agda.Builtin.String.html#274" class="Postulate">String</a>


<a id="2006" class="Comment">---------------------------------------------------------------------</a>
<a id="2076" class="Comment">-- Generic Printing Semantics</a>

<a id="2107" class="Comment">-- Given a strategy to `Display` one layer of term we can generate a full</a>
<a id="2181" class="Comment">-- printer.</a>

<a id="2194" class="Keyword">open</a> <a id="2199" href="Generic.Semantics.html#814" class="Module">Semantics</a>

<a id="2210" class="Keyword">module</a> <a id="2217" href="Generic.Semantics.Printing.html#2217" class="Module">_</a> <a id="2219" class="Symbol">{</a><a id="2220" href="Generic.Semantics.Printing.html#2220" class="Bound">d</a> <a id="2222" class="Symbol">:</a> <a id="2224" href="Generic.Syntax.html#527" class="Datatype">Desc</a> <a id="2229" href="Generic.Semantics.Printing.html#74" class="Bound">I</a><a id="2230" class="Symbol">}</a> <a id="2232" class="Keyword">where</a>


  <a id="2242" href="Generic.Semantics.Printing.html#2242" class="Function">Printing</a> <a id="2251" class="Symbol">:</a> <a id="2253" href="Generic.Semantics.Printing.html#1933" class="Function">Display</a> <a id="2261" href="Generic.Semantics.Printing.html#2220" class="Bound">d</a> <a id="2263" class="Symbol">â†’</a> <a id="2265" href="Generic.Semantics.html#814" class="Record">Semantics</a> <a id="2275" href="Generic.Semantics.Printing.html#2220" class="Bound">d</a> <a id="2277" href="StateOfTheArt.ACMM.html#3828" class="Function">Name</a> <a id="2282" href="StateOfTheArt.ACMM.html#3867" class="Function">Printer</a>
  <a id="2292" href="Generic.Semantics.Printing.html#2242" class="Function">Printing</a> <a id="2301" href="Generic.Semantics.Printing.html#2301" class="Bound">dis</a> <a id="2305" class="Symbol">.</a><a id="2306" href="Generic.Semantics.html#879" class="Field">th^ğ“¥</a>  <a id="2312" class="Symbol">=</a> <a id="2314" href="StateOfTheArt.ACMM.html#3921" class="Function">th^Wrap</a>
  <a id="2324" href="Generic.Semantics.Printing.html#2242" class="Function">Printing</a> <a id="2333" href="Generic.Semantics.Printing.html#2333" class="Bound">dis</a> <a id="2337" class="Symbol">.</a><a id="2338" href="Generic.Semantics.html#906" class="Field">var</a>   <a id="2344" class="Symbol">=</a> <a id="2346" href="StateOfTheArt.ACMM.html#3986" class="Function">map^Wrap</a> <a id="2355" href="Category.Monad.Indexed.html#644" class="Function">return</a>
  <a id="2364" href="Generic.Semantics.Printing.html#2242" class="Function">Printing</a> <a id="2373" href="Generic.Semantics.Printing.html#2373" class="Bound">dis</a> <a id="2377" class="Symbol">.</a><a id="2378" href="Generic.Semantics.html#931" class="Field">alg</a>   <a id="2384" class="Symbol">=</a> <a id="2386" class="Symbol">Î»</a> <a id="2388" href="Generic.Semantics.Printing.html#2388" class="Bound">v</a> <a id="2390" class="Symbol">â†’</a> <a id="2392" href="StateOfTheArt.ACMM.html#3787" class="InductiveConstructor">MkW</a> <a id="2396" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="2398" href="Generic.Semantics.Printing.html#2373" class="Bound">dis</a> <a id="2402" href="Category.Functor.html#608" class="Function Operator">&lt;$&gt;</a> <a id="2406" href="Generic.Syntax.html#4894" class="Function">mapA</a> <a id="2411" href="Generic.Semantics.Printing.html#2220" class="Bound">d</a> <a id="2413" href="Generic.Semantics.Printing.html#1628" class="Function">reify^Pieces</a> <a id="2426" href="Generic.Semantics.Printing.html#2388" class="Bound">v</a>

    <a id="2433" class="Keyword">where</a> <a id="2439" class="Keyword">open</a> <a id="2444" href="Generic.Syntax.html" class="Module">Generic.Syntax</a>
          <a id="2469" class="Keyword">open</a> <a id="2474" href="Generic.Semantics.Printing.html#766" class="Module">ST</a>
          <a id="2487" class="Keyword">instance</a> <a id="2496" href="Generic.Semantics.Printing.html#2496" class="Symbol">_</a> <a id="2498" class="Symbol">=</a> <a id="2500" href="Generic.Semantics.Printing.html#858" class="Function">ApplicativeM</a>

<a id="2514" class="Comment">-- Corollary: a generic printer using a silly name supply</a>


  <a id="2576" class="Keyword">open</a> <a id="2581" href="Data.Environment.html" class="Module">Data.Environment</a>
  <a id="2600" class="Keyword">instance</a> <a id="2609" href="Generic.Semantics.Printing.html#2609" class="Function">_</a> <a id="2611" class="Symbol">=</a> <a id="2613" href="Generic.Semantics.Printing.html#858" class="Function">ApplicativeM</a>


  <a id="2630" href="Generic.Semantics.Printing.html#2630" class="Function">print</a> <a id="2636" class="Symbol">:</a> <a id="2638" href="Generic.Semantics.Printing.html#1933" class="Function">Display</a> <a id="2646" href="Generic.Semantics.Printing.html#2220" class="Bound">d</a> <a id="2648" class="Symbol">â†’</a> <a id="2650" href="Generic.Syntax.html#1317" class="Datatype">Tm</a> <a id="2653" href="Generic.Semantics.Printing.html#2220" class="Bound">d</a> <a id="2655" href="Generic.Semantics.Printing.html#652" class="Generalizable">i</a> <a id="2657" href="Generic.Semantics.Printing.html#642" class="Generalizable">Ïƒ</a> <a id="2659" href="Generic.Semantics.Printing.html#625" class="Generalizable">Î“</a> <a id="2661" class="Symbol">â†’</a> <a id="2663" href="Agda.Builtin.String.html#274" class="Postulate">String</a>

  <a id="2673" href="Generic.Semantics.Printing.html#2630" class="Function">print</a> <a id="2679" href="Generic.Semantics.Printing.html#2679" class="Bound">dis</a> <a id="2683" href="Generic.Semantics.Printing.html#2683" class="Bound">t</a> <a id="2685" class="Symbol">=</a> <a id="2687" href="Agda.Builtin.Sigma.html#252" class="Field">projâ‚</a> <a id="2693" class="Symbol">(</a><a id="2694" href="Generic.Semantics.Printing.html#2719" class="Function">printer</a> <a id="2702" href="StateOfTheArt.ACMM.html#5074" class="Function">names</a><a id="2707" class="Symbol">)</a> <a id="2709" class="Keyword">where</a>
    <a id="2719" href="Generic.Semantics.Printing.html#2719" class="Function">printer</a> <a id="2727" class="Symbol">:</a> <a id="2729" href="StateOfTheArt.ACMM.html#3664" class="Function">Fresh</a> <a id="2735" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
    <a id="2746" href="Generic.Semantics.Printing.html#2719" class="Function">printer</a> <a id="2754" class="Symbol">=</a> <a id="2756" class="Keyword">do</a>
      <a id="2765" href="Generic.Semantics.Printing.html#2765" class="Bound">init</a> <a id="2770" href="Category.Monad.Indexed.html#677" class="Function Operator">â†</a> <a id="2772" href="Data.Environment.html#5773" class="Function">sequenceA</a> <a id="2782" class="Symbol">(</a><a id="2783" href="Data.Var.Varlike.html#620" class="Function">base</a> <a id="2788" href="Generic.Semantics.Printing.html#1105" class="Function">vl^FreshName</a><a id="2800" class="Symbol">)</a>
      <a id="2808" href="StateOfTheArt.ACMM.html#3798" class="Field">getW</a> <a id="2813" class="Symbol">(</a><a id="2814" href="Generic.Semantics.html#971" class="Function">Semantics.semantics</a> <a id="2834" class="Symbol">(</a><a id="2835" href="Generic.Semantics.Printing.html#2242" class="Function">Printing</a> <a id="2844" href="Generic.Semantics.Printing.html#2679" class="Bound">dis</a><a id="2847" class="Symbol">)</a> <a id="2849" href="Generic.Semantics.Printing.html#2765" class="Bound">init</a> <a id="2854" href="Generic.Semantics.Printing.html#2683" class="Bound">t</a><a id="2855" class="Symbol">)</a>

</pre></body></html>