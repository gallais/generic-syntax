<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Generic.Semantics.Printing</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Keyword">module</a> <a id="8" href="Generic.Semantics.Printing.html" class="Module">Generic.Semantics.Printing</a> <a id="35" class="Keyword">where</a>

<a id="42" class="Keyword">open</a> <a id="47" class="Keyword">import</a> <a id="54" href="Codata.Thunk.html" class="Module">Codata.Thunk</a>
<a id="67" class="Keyword">open</a> <a id="72" class="Keyword">import</a> <a id="79" href="Codata.Stream.html" class="Module">Codata.Stream</a> <a id="93" class="Symbol">as</a> <a id="96" class="Module">Stream</a> <a id="103" class="Keyword">using</a> <a id="109" class="Symbol">(</a><a id="110" href="Codata.Stream.html#624" class="Datatype">Stream</a><a id="116" class="Symbol">;</a> <a id="118" href="Codata.Stream.html#674" class="InductiveConstructor Operator">_∷_</a><a id="121" class="Symbol">)</a>

<a id="124" class="Keyword">open</a> <a id="129" class="Keyword">import</a> <a id="136" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="146" class="Keyword">open</a> <a id="151" class="Keyword">import</a> <a id="158" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="168" class="Keyword">open</a> <a id="173" class="Keyword">import</a> <a id="180" href="Data.Product.html" class="Module">Data.Product</a>
<a id="193" class="Keyword">open</a> <a id="198" class="Keyword">import</a> <a id="205" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="219" class="Keyword">open</a> <a id="224" class="Keyword">import</a> <a id="231" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a> <a id="245" class="Symbol">as</a> <a id="248" class="Module">Nat</a>
<a id="252" class="Keyword">open</a> <a id="257" class="Keyword">import</a> <a id="264" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="279" class="Keyword">using</a> <a id="285" class="Symbol">(</a><a id="286" href="Agda.Builtin.List.html#80" class="Datatype">List</a><a id="290" class="Symbol">;</a> <a id="292" href="Data.List.Base.html#8785" class="InductiveConstructor">[]</a><a id="294" class="Symbol">;</a> <a id="296" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">_∷_</a><a id="299" class="Symbol">)</a>
<a id="301" class="Keyword">open</a> <a id="306" class="Keyword">import</a> <a id="313" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="332" class="Symbol">as</a> <a id="335" class="Module">List⁺</a> <a id="341" class="Keyword">using</a> <a id="347" class="Symbol">(</a><a id="348" href="Data.List.NonEmpty.html#1135" class="Record">List⁺</a><a id="353" class="Symbol">;</a> <a id="355" href="Data.List.NonEmpty.html#1185" class="InductiveConstructor Operator">_∷_</a><a id="358" class="Symbol">)</a>
<a id="360" class="Keyword">open</a> <a id="365" class="Keyword">import</a> <a id="372" href="Data.Char.html" class="Module">Data.Char</a>
<a id="382" class="Keyword">open</a> <a id="387" class="Keyword">import</a> <a id="394" href="Data.String.html" class="Module">Data.String</a> <a id="406" class="Keyword">using</a> <a id="412" class="Symbol">(</a><a id="413" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="420" class="Symbol">;</a> <a id="422" href="Data.String.Base.html#1089" class="Function Operator">_++_</a> <a id="427" class="Symbol">;</a> <a id="429" href="Data.String.Base.html#924" class="Function">fromList</a> <a id="438" class="Symbol">;</a> <a id="440" href="Data.String.Base.html#869" class="Function">toList</a><a id="446" class="Symbol">)</a>
<a id="448" class="Keyword">open</a> <a id="453" class="Keyword">import</a> <a id="460" href="Category.Monad.html" class="Module">Category.Monad</a>
<a id="475" class="Keyword">open</a> <a id="480" class="Keyword">import</a> <a id="487" href="Category.Monad.State.html" class="Module">Category.Monad.State</a>
<a id="508" class="Keyword">open</a> <a id="513" class="Keyword">import</a> <a id="520" href="Function.html" class="Module">Function</a>


<a id="531" class="Comment">-- The Printing Monad we are working with: a state containing a stream</a>
<a id="602" class="Comment">-- of *distinct* Strings.</a>
<a id="628" class="Keyword">open</a> <a id="633" class="Keyword">module</a> <a id="ST"></a><a id="640" href="Generic.Semantics.Printing.html#640" class="Module">ST</a> <a id="643" class="Symbol">=</a> <a id="645" href="Category.Monad.State.html#2465" class="Module">RawMonadState</a> <a id="659" class="Symbol">(</a><a id="660" href="Category.Monad.State.html#3432" class="Function">StateMonadState</a> <a id="676" class="Symbol">(</a><a id="677" href="Codata.Stream.html#624" class="Datatype">Stream</a> <a id="684" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="691" class="Symbol">_))</a>
<a id="M"></a><a id="695" href="Generic.Semantics.Printing.html#695" class="Function">M</a> <a id="697" class="Symbol">=</a> <a id="699" href="Category.Monad.State.html#3274" class="Function">State</a> <a id="705" class="Symbol">(</a><a id="706" href="Codata.Stream.html#624" class="Datatype">Stream</a> <a id="713" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="720" class="Symbol">_)</a>

<a id="724" class="Keyword">open</a> <a id="729" class="Keyword">import</a> <a id="736" href="var.html" class="Module">var</a> <a id="740" class="Keyword">hiding</a> <a id="747" class="Symbol">(</a><a id="748" href="var.html#673" class="Function">get</a><a id="751" class="Symbol">)</a>
<a id="753" class="Keyword">open</a> <a id="758" class="Keyword">import</a> <a id="765" href="environment.html" class="Module">environment</a> <a id="777" class="Symbol">as</a> <a id="780" class="Module">E</a>
<a id="782" class="Keyword">open</a> <a id="787" class="Keyword">import</a> <a id="794" href="varlike.html" class="Module">varlike</a>
<a id="802" class="Keyword">open</a> <a id="807" class="Keyword">import</a> <a id="814" href="Generic.Syntax.html" class="Module">Generic.Syntax</a> <a id="829" class="Symbol">as</a> <a id="832" class="Module">S</a>
<a id="834" class="Keyword">open</a> <a id="839" class="Keyword">import</a> <a id="846" href="Generic.Semantics.html" class="Module">Generic.Semantics</a>

<a id="865" class="Comment">-- First we use some wrappers with phantom indices for the type of</a>
<a id="932" class="Comment">-- Values and Computations of our Semantics</a>

<a id="977" class="Keyword">module</a> <a id="984" href="Generic.Semantics.Printing.html#984" class="Module">_</a> <a id="986" class="Symbol">{</a><a id="987" href="Generic.Semantics.Printing.html#987" class="Bound">I</a> <a id="989" class="Symbol">:</a> <a id="991" class="PrimitiveType">Set</a><a id="994" class="Symbol">}</a> <a id="996" class="Keyword">where</a>

  <a id="1005" class="Keyword">record</a> <a id="1012" href="Generic.Semantics.Printing.html#1012" class="Record">Name</a> <a id="1017" class="Symbol">(</a><a id="1018" href="Generic.Semantics.Printing.html#1018" class="Bound">i</a> <a id="1020" class="Symbol">:</a> <a id="1022" href="Generic.Semantics.Printing.html#987" class="Bound">I</a><a id="1023" class="Symbol">)</a> <a id="1025" class="Symbol">(</a><a id="1026" href="Generic.Semantics.Printing.html#1026" class="Bound">Γ</a> <a id="1028" class="Symbol">:</a> <a id="1030" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1035" href="Generic.Semantics.Printing.html#987" class="Bound">I</a><a id="1036" class="Symbol">)</a> <a id="1038" class="Symbol">:</a> <a id="1040" class="PrimitiveType">Set</a> <a id="1044" class="Keyword">where</a>
    <a id="1054" class="Keyword">constructor</a> <a id="1066" href="Generic.Semantics.Printing.html#1066" class="InductiveConstructor">mkN</a><a id="1069" class="Symbol">;</a> <a id="1071" class="Keyword">field</a> <a id="1077" href="Generic.Semantics.Printing.html#1077" class="Field">getN</a> <a id="1082" class="Symbol">:</a> <a id="1084" href="Agda.Builtin.String.html#165" class="Postulate">String</a>
  <a id="1093" class="Keyword">open</a> <a id="1098" href="Generic.Semantics.Printing.html#1012" class="Module">Name</a> <a id="1103" class="Keyword">public</a>

  <a id="1113" class="Keyword">record</a> <a id="1120" href="Generic.Semantics.Printing.html#1120" class="Record">Printer</a> <a id="1128" class="Symbol">(</a><a id="1129" href="Generic.Semantics.Printing.html#1129" class="Bound">i</a> <a id="1131" class="Symbol">:</a> <a id="1133" href="Generic.Semantics.Printing.html#987" class="Bound">I</a><a id="1134" class="Symbol">)</a> <a id="1136" class="Symbol">(</a><a id="1137" href="Generic.Semantics.Printing.html#1137" class="Bound">Γ</a> <a id="1139" class="Symbol">:</a> <a id="1141" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1146" href="Generic.Semantics.Printing.html#987" class="Bound">I</a><a id="1147" class="Symbol">)</a> <a id="1149" class="Symbol">:</a> <a id="1151" class="PrimitiveType">Set</a> <a id="1155" class="Keyword">where</a>
    <a id="1165" class="Keyword">constructor</a> <a id="1177" href="Generic.Semantics.Printing.html#1177" class="InductiveConstructor">mkP</a><a id="1180" class="Symbol">;</a> <a id="1182" class="Keyword">field</a> <a id="1188" href="Generic.Semantics.Printing.html#1188" class="Field">getP</a> <a id="1193" class="Symbol">:</a> <a id="1195" href="Generic.Semantics.Printing.html#695" class="Function">M</a> <a id="1197" href="Agda.Builtin.String.html#165" class="Postulate">String</a>
  <a id="1206" class="Keyword">open</a> <a id="1211" href="Generic.Semantics.Printing.html#1120" class="Module">Printer</a> <a id="1219" class="Keyword">public</a>

<a id="1227" class="Comment">-- We define a handy combinator to generate fresh Names (and make sure</a>
<a id="1298" class="Comment">-- they are dropped from the state)</a>

<a id="1335" class="Keyword">module</a> <a id="1342" href="Generic.Semantics.Printing.html#1342" class="Module">_</a> <a id="1344" class="Symbol">{</a><a id="1345" href="Generic.Semantics.Printing.html#1345" class="Bound">I</a> <a id="1347" class="Symbol">:</a> <a id="1349" class="PrimitiveType">Set</a><a id="1352" class="Symbol">}</a> <a id="1354" class="Keyword">where</a>

  <a id="1363" href="Generic.Semantics.Printing.html#1363" class="Function">fresh</a> <a id="1369" class="Symbol">:</a> <a id="1371" class="Symbol">{</a><a id="1372" href="Generic.Semantics.Printing.html#1372" class="Bound">i</a> <a id="1374" class="Symbol">:</a> <a id="1376" href="Generic.Semantics.Printing.html#1345" class="Bound">I</a><a id="1377" class="Symbol">}</a> <a id="1379" class="Symbol">{</a><a id="1380" href="Generic.Semantics.Printing.html#1380" class="Bound">Γ</a> <a id="1382" class="Symbol">:</a> <a id="1384" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1389" href="Generic.Semantics.Printing.html#1345" class="Bound">I</a><a id="1390" class="Symbol">}</a> <a id="1392" class="Symbol">→</a> <a id="1394" href="Generic.Semantics.Printing.html#695" class="Function">M</a> <a id="1396" class="Symbol">(</a><a id="1397" href="Generic.Semantics.Printing.html#1012" class="Record">Name</a> <a id="1402" href="Generic.Semantics.Printing.html#1372" class="Bound">i</a> <a id="1404" href="Generic.Semantics.Printing.html#1380" class="Bound">Γ</a><a id="1405" class="Symbol">)</a>
  <a id="1409" href="Generic.Semantics.Printing.html#1363" class="Function">fresh</a> <a id="1415" class="Symbol">=</a>  <a id="1418" href="Category.Monad.State.html#1758" class="Function">get</a>                    <a id="1441" href="Category.Monad.Indexed.html#568" class="Function Operator">&gt;&gt;=</a>  <a id="1446" class="Symbol">λ</a> <a id="1448" href="Generic.Semantics.Printing.html#1448" class="Bound">nms</a>  <a id="1453" class="Symbol">→</a>
           <a id="1466" href="Category.Monad.State.html#1790" class="Function">put</a> <a id="1470" class="Symbol">(</a><a id="1471" href="Codata.Stream.html#877" class="Function">Stream.tail</a> <a id="1483" href="Generic.Semantics.Printing.html#1448" class="Bound">nms</a><a id="1486" class="Symbol">)</a>  <a id="1489" href="Category.Monad.Indexed.html#568" class="Function Operator">&gt;&gt;=</a>  <a id="1494" class="Symbol">λ</a> <a id="1496" href="Generic.Semantics.Printing.html#1496" class="Bound">_</a>    <a id="1501" class="Symbol">→</a>
           <a id="1514" href="Category.Monad.Indexed.html#533" class="Function">return</a> <a id="1521" href="Function.html#1891" class="Function Operator">$</a> <a id="1523" href="Generic.Semantics.Printing.html#1066" class="InductiveConstructor">mkN</a> <a id="1527" href="Function.html#1891" class="Function Operator">$</a> <a id="1529" href="Codata.Stream.html#826" class="Function">Stream.head</a> <a id="1541" href="Generic.Semantics.Printing.html#1448" class="Bound">nms</a>

<a id="1546" class="Comment">-- Names are varlike in the monad M: we use the state to generate fresh</a>
<a id="1618" class="Comment">-- ones. Closure under thinning is a matter of wrapping / unwrapping the</a>
<a id="1691" class="Comment">-- name.</a>

  <a id="1703" href="Generic.Semantics.Printing.html#1703" class="Function">vl^StName</a> <a id="1713" class="Symbol">:</a> <a id="1715" href="varlike.html#326" class="Record">VarLike</a> <a id="1723" class="Symbol">(λ</a> <a id="1726" href="Generic.Semantics.Printing.html#1726" class="Bound">i</a> <a id="1728" href="Generic.Semantics.Printing.html#1728" class="Bound">Γ</a> <a id="1730" class="Symbol">→</a> <a id="1732" href="Generic.Semantics.Printing.html#695" class="Function">M</a> <a id="1734" class="Symbol">(</a><a id="1735" href="Generic.Semantics.Printing.html#1012" class="Record">Name</a> <a id="1740" href="Generic.Semantics.Printing.html#1726" class="Bound">i</a> <a id="1742" href="Generic.Semantics.Printing.html#1728" class="Bound">Γ</a><a id="1743" class="Symbol">))</a>
  <a id="1748" href="varlike.html#372" class="Field">new</a>   <a id="1754" href="Generic.Semantics.Printing.html#1703" class="Function">vl^StName</a> <a id="1764" class="Symbol">=</a> <a id="1766" href="Generic.Semantics.Printing.html#1363" class="Function">fresh</a>
  <a id="1774" href="varlike.html#417" class="Field">th^𝓥</a> <a id="1779" href="Generic.Semantics.Printing.html#1703" class="Function">vl^StName</a> <a id="1789" class="Symbol">=</a> <a id="1791" class="Symbol">λ</a> <a id="1793" href="Generic.Semantics.Printing.html#1793" class="Bound">st</a> <a id="1796" href="Generic.Semantics.Printing.html#1796" class="Bound">_</a> <a id="1798" class="Symbol">→</a> <a id="1800" href="Generic.Semantics.Printing.html#1066" class="InductiveConstructor">mkN</a> <a id="1804" href="Function.html#769" class="Function Operator">∘</a> <a id="1806" href="Generic.Semantics.Printing.html#1077" class="Field">getN</a> <a id="1811" href="Category.Functor.html#492" class="Function Operator">ST.&lt;$&gt;</a> <a id="1818" href="Generic.Semantics.Printing.html#1793" class="Bound">st</a>


<a id="1823" class="Comment">-- To print a term the user need to explain to us how to display one</a>
<a id="1892" class="Comment">-- layer of term given that the newly-bound variables have been assigned</a>
<a id="1965" class="Comment">-- fresh names and the subterms have already been rendered using these</a>
<a id="2036" class="Comment">-- names.</a>

<a id="2047" class="Keyword">module</a> <a id="2054" href="Generic.Semantics.Printing.html#2054" class="Module">_</a> <a id="2056" class="Symbol">{</a><a id="2057" href="Generic.Semantics.Printing.html#2057" class="Bound">I</a> <a id="2059" class="Symbol">:</a> <a id="2061" class="PrimitiveType">Set</a><a id="2064" class="Symbol">}</a> <a id="2066" class="Symbol">(</a><a id="2067" href="Generic.Semantics.Printing.html#2067" class="Bound">d</a> <a id="2069" class="Symbol">:</a> <a id="2071" href="Generic.Syntax.html#381" class="Datatype">Desc</a> <a id="2076" href="Generic.Semantics.Printing.html#2057" class="Bound">I</a><a id="2077" class="Symbol">)</a> <a id="2079" class="Keyword">where</a>

  <a id="2088" href="Generic.Semantics.Printing.html#2088" class="Function">Pieces</a> <a id="2095" class="Symbol">:</a> <a id="2097" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="2102" href="Generic.Semantics.Printing.html#2057" class="Bound">I</a> <a id="2104" class="Symbol">→</a> <a id="2106" href="Generic.Semantics.Printing.html#2057" class="Bound">I</a> <a id="2108" href="var.html#469" class="Function Operator">─Scoped</a>
  <a id="2118" href="Generic.Semantics.Printing.html#2088" class="Function">Pieces</a> <a id="2125" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>  <a id="2129" href="Generic.Semantics.Printing.html#2129" class="Bound">i</a> <a id="2131" href="Generic.Semantics.Printing.html#2131" class="Bound">Γ</a> <a id="2133" class="Symbol">=</a> <a id="2135" href="Agda.Builtin.String.html#165" class="Postulate">String</a>
  <a id="2144" href="Generic.Semantics.Printing.html#2088" class="CatchallClause Function">Pieces</a><a id="2150" class="CatchallClause"> </a><a id="2151" href="Generic.Semantics.Printing.html#2151" class="CatchallClause Bound">Δ</a><a id="2152" class="CatchallClause">   </a><a id="2155" href="Generic.Semantics.Printing.html#2155" class="CatchallClause Bound">i</a><a id="2156" class="CatchallClause"> </a><a id="2157" href="Generic.Semantics.Printing.html#2157" class="CatchallClause Bound">Γ</a> <a id="2159" class="Symbol">=</a> <a id="2161" class="Symbol">(</a><a id="2162" href="Generic.Semantics.Printing.html#2151" class="Bound">Δ</a> <a id="2164" href="environment.html#309" class="Record Operator">─Env</a><a id="2168" class="Symbol">)</a> <a id="2170" class="Symbol">(λ</a> <a id="2173" href="Generic.Semantics.Printing.html#2173" class="Bound">_</a> <a id="2175" href="Generic.Semantics.Printing.html#2175" class="Bound">_</a> <a id="2177" class="Symbol">→</a> <a id="2179" href="Agda.Builtin.String.html#165" class="Postulate">String</a><a id="2185" class="Symbol">)</a> <a id="2187" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a> <a id="2190" href="Data.Product.html#1353" class="Function Operator">×</a> <a id="2192" href="Agda.Builtin.String.html#165" class="Postulate">String</a>

  <a id="2202" class="Keyword">record</a> <a id="2209" href="Generic.Semantics.Printing.html#2209" class="Record">Display</a> <a id="2217" class="Symbol">:</a> <a id="2219" class="PrimitiveType">Set</a> <a id="2223" class="Keyword">where</a>
    <a id="2233" class="Keyword">constructor</a> <a id="2245" href="Generic.Semantics.Printing.html#2245" class="InductiveConstructor">mkD</a>
    <a id="2253" class="Keyword">field</a> <a id="2259" href="Generic.Semantics.Printing.html#2259" class="Field">getD</a> <a id="2264" class="Symbol">:</a> <a id="2266" class="Symbol">∀</a> <a id="2268" class="Symbol">{</a><a id="2269" href="Generic.Semantics.Printing.html#2269" class="Bound">i</a> <a id="2271" href="Generic.Semantics.Printing.html#2271" class="Bound">Γ</a><a id="2272" class="Symbol">}</a> <a id="2274" class="Symbol">→</a> <a id="2276" href="Generic.Syntax.html#727" class="Function Operator">⟦</a> <a id="2278" href="Generic.Semantics.Printing.html#2067" class="Bound">d</a> <a id="2280" href="Generic.Syntax.html#727" class="Function Operator">⟧</a> <a id="2282" href="Generic.Semantics.Printing.html#2088" class="Function">Pieces</a> <a id="2289" href="Generic.Semantics.Printing.html#2269" class="Bound">i</a> <a id="2291" href="Generic.Semantics.Printing.html#2271" class="Bound">Γ</a> <a id="2293" class="Symbol">→</a> <a id="2295" href="Agda.Builtin.String.html#165" class="Postulate">String</a>
  <a id="2304" class="Keyword">open</a> <a id="2309" href="Generic.Semantics.Printing.html#2209" class="Module">Display</a> <a id="2317" class="Keyword">public</a>

<a id="2325" class="Comment">---------------------------------------------------------------------</a>
<a id="2395" class="Comment">-- Generic Printing Semantics</a>

<a id="2426" class="Comment">-- Given a strategy to `Display` one layer of term we can generate a full</a>
<a id="2500" class="Comment">-- printer.</a>

<a id="2513" class="Keyword">module</a> <a id="2520" href="Generic.Semantics.Printing.html#2520" class="Module">_</a> <a id="2522" class="Symbol">{</a><a id="2523" href="Generic.Semantics.Printing.html#2523" class="Bound">I</a> <a id="2525" class="Symbol">:</a> <a id="2527" class="PrimitiveType">Set</a><a id="2530" class="Symbol">}</a> <a id="2532" class="Symbol">{</a><a id="2533" href="Generic.Semantics.Printing.html#2533" class="Bound">d</a> <a id="2535" class="Symbol">:</a> <a id="2537" href="Generic.Syntax.html#381" class="Datatype">Desc</a> <a id="2542" href="Generic.Semantics.Printing.html#2523" class="Bound">I</a><a id="2543" class="Symbol">}</a> <a id="2545" class="Keyword">where</a>

  <a id="2554" href="Generic.Semantics.Printing.html#2554" class="Function">printing</a> <a id="2563" class="Symbol">:</a> <a id="2565" href="Generic.Semantics.Printing.html#2209" class="Record">Display</a> <a id="2573" href="Generic.Semantics.Printing.html#2533" class="Bound">d</a> <a id="2575" class="Symbol">→</a> <a id="2577" href="Generic.Semantics.html#487" class="Record">Sem</a> <a id="2581" href="Generic.Semantics.Printing.html#2533" class="Bound">d</a> <a id="2583" href="Generic.Semantics.Printing.html#1012" class="Record">Name</a> <a id="2588" href="Generic.Semantics.Printing.html#1120" class="Record">Printer</a>
  <a id="2598" href="Generic.Semantics.html#552" class="Field">Sem.th^𝓥</a> <a id="2607" class="Symbol">(</a><a id="2608" href="Generic.Semantics.Printing.html#2554" class="Function">printing</a> <a id="2617" href="Generic.Semantics.Printing.html#2617" class="Bound">dis</a><a id="2620" class="Symbol">)</a>        <a id="2629" href="Generic.Semantics.Printing.html#2629" class="Bound">n</a> <a id="2631" class="Symbol">=</a> <a id="2633" href="Function.html#1109" class="Function">const</a> <a id="2639" href="Function.html#1891" class="Function Operator">$</a> <a id="2641" href="Generic.Semantics.Printing.html#1066" class="InductiveConstructor">mkN</a> <a id="2645" class="Symbol">(</a><a id="2646" href="Generic.Semantics.Printing.html#1077" class="Field">getN</a> <a id="2651" href="Generic.Semantics.Printing.html#2629" class="Bound">n</a><a id="2652" class="Symbol">)</a>
  <a id="2656" href="Generic.Semantics.html#595" class="Field">Sem.var</a>  <a id="2665" class="Symbol">(</a><a id="2666" href="Generic.Semantics.Printing.html#2554" class="Function">printing</a> <a id="2675" href="Generic.Semantics.Printing.html#2675" class="Bound">dis</a><a id="2678" class="Symbol">)</a>         <a id="2688" href="Generic.Semantics.Printing.html#2688" class="Bound">n</a> <a id="2690" class="Symbol">=</a> <a id="2692" href="Generic.Semantics.Printing.html#1177" class="InductiveConstructor">mkP</a> <a id="2696" class="Symbol">(</a><a id="2697" href="Category.Monad.Indexed.html#533" class="Function">return</a> <a id="2704" class="Symbol">(</a><a id="2705" href="Generic.Semantics.Printing.html#1077" class="Field">getN</a> <a id="2710" href="Generic.Semantics.Printing.html#2688" class="Bound">n</a><a id="2711" class="Symbol">))</a>
  <a id="2716" href="Generic.Semantics.html#654" class="Field">Sem.alg</a>  <a id="2725" class="Symbol">(</a><a id="2726" href="Generic.Semantics.Printing.html#2554" class="Function">printing</a> <a id="2735" href="Generic.Semantics.Printing.html#2735" class="Bound">dis</a><a id="2738" class="Symbol">)</a> <a id="2740" class="Symbol">{</a><a id="2741" href="Generic.Semantics.Printing.html#2741" class="Bound">i</a><a id="2742" class="Symbol">}</a> <a id="2744" class="Symbol">{</a><a id="2745" href="Generic.Semantics.Printing.html#2745" class="Bound">Γ</a><a id="2746" class="Symbol">}</a> <a id="2748" href="Generic.Semantics.Printing.html#2748" class="Bound">v</a> <a id="2750" class="Symbol">=</a> <a id="2752" href="Generic.Semantics.Printing.html#1177" class="InductiveConstructor">mkP</a> <a id="2756" href="Function.html#1891" class="Function Operator">$</a> <a id="2758" href="Generic.Semantics.Printing.html#2259" class="Field">getD</a> <a id="2763" href="Generic.Semantics.Printing.html#2735" class="Bound">dis</a> <a id="2767" href="Category.Functor.html#492" class="Function Operator">ST.&lt;$&gt;</a> <a id="2774" href="Generic.Semantics.Printing.html#3220" class="Function">ih</a> <a id="2777" class="Keyword">where</a>

    <a id="2788" href="Generic.Semantics.Printing.html#2788" class="Function">reify^M</a> <a id="2796" class="Symbol">:</a> <a id="2798" class="Symbol">{</a><a id="2799" href="Generic.Semantics.Printing.html#2799" class="Bound">Γ</a> <a id="2801" class="Symbol">:</a> <a id="2803" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="2808" href="Generic.Semantics.Printing.html#2523" class="Bound">I</a><a id="2809" class="Symbol">}</a> <a id="2811" class="Symbol">(</a><a id="2812" href="Generic.Semantics.Printing.html#2812" class="Bound">Δ</a> <a id="2814" class="Symbol">:</a> <a id="2816" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="2821" href="Generic.Semantics.Printing.html#2523" class="Bound">I</a><a id="2822" class="Symbol">)</a> <a id="2824" class="Symbol">(</a><a id="2825" href="Generic.Semantics.Printing.html#2825" class="Bound">i</a> <a id="2827" class="Symbol">:</a> <a id="2829" href="Generic.Semantics.Printing.html#2523" class="Bound">I</a><a id="2830" class="Symbol">)</a> <a id="2832" class="Symbol">→</a>
              <a id="2848" href="environment.html#3741" class="Function">Kripke</a> <a id="2855" href="Generic.Semantics.Printing.html#1012" class="Record">Name</a> <a id="2860" href="Generic.Semantics.Printing.html#1120" class="Record">Printer</a> <a id="2868" href="Generic.Semantics.Printing.html#2812" class="Bound">Δ</a> <a id="2870" href="Generic.Semantics.Printing.html#2825" class="Bound">i</a> <a id="2872" href="Generic.Semantics.Printing.html#2799" class="Bound">Γ</a> <a id="2874" class="Symbol">→</a>
              <a id="2890" href="Generic.Semantics.Printing.html#695" class="Function">M</a> <a id="2892" class="Symbol">(</a><a id="2893" href="Generic.Semantics.Printing.html#2088" class="Function">Pieces</a> <a id="2900" href="Generic.Semantics.Printing.html#2533" class="Bound">d</a> <a id="2902" href="Generic.Semantics.Printing.html#2812" class="Bound">Δ</a> <a id="2904" href="Generic.Semantics.Printing.html#2825" class="Bound">i</a> <a id="2906" href="Generic.Semantics.Printing.html#2799" class="Bound">Γ</a><a id="2907" class="Symbol">)</a>
    <a id="2913" href="Generic.Semantics.Printing.html#2788" class="Function">reify^M</a> <a id="2921" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>         <a id="2932" href="Generic.Semantics.Printing.html#2932" class="Bound">i</a> <a id="2934" class="Symbol">=</a> <a id="2936" href="Generic.Semantics.Printing.html#1188" class="Field">getP</a>
    <a id="2945" href="Generic.Semantics.Printing.html#2788" class="Function">reify^M</a> <a id="2953" href="Generic.Semantics.Printing.html#2953" class="Bound">Δ</a><a id="2954" class="Symbol">@(_</a> <a id="2958" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="2960" class="Symbol">_)</a>  <a id="2964" href="Generic.Semantics.Printing.html#2964" class="Bound">i</a> <a id="2966" class="Symbol">=</a> <a id="2968" class="Symbol">λ</a> <a id="2970" href="Generic.Semantics.Printing.html#2970" class="Bound">f</a> <a id="2972" class="Symbol">→</a> <a id="2974" class="Keyword">let</a> <a id="2978" href="Generic.Semantics.Printing.html#2978" class="Bound">σ</a> <a id="2980" class="Symbol">=</a> <a id="2982" href="varlike.html#661" class="Function">freshˡ</a> <a id="2989" href="Generic.Semantics.Printing.html#1703" class="Function">vl^StName</a> <a id="2999" class="Symbol">_</a>
                                <a id="3033" class="Keyword">in</a>  <a id="3037" href="environment.html#4324" class="Function">E.traverse</a> <a id="3048" href="Category.Monad.Indexed.html#1104" class="Function">rawIApplicative</a> <a id="3064" href="Generic.Semantics.Printing.html#2978" class="Bound">σ</a> <a id="3066" href="Category.Monad.Indexed.html#568" class="Function Operator">&gt;&gt;=</a> <a id="3070" class="Symbol">λ</a> <a id="3072" href="Generic.Semantics.Printing.html#3072" class="Bound">ρ</a> <a id="3074" class="Symbol">→</a>
                                    <a id="3112" href="Generic.Semantics.Printing.html#1188" class="Field">getP</a> <a id="3117" class="Symbol">(</a><a id="3118" href="Generic.Semantics.Printing.html#2970" class="Bound">f</a> <a id="3120" class="Symbol">(</a><a id="3121" href="varlike.html#555" class="Function">freshʳ</a> <a id="3128" href="varlike.html#863" class="Function">vl^Var</a> <a id="3135" href="Generic.Semantics.Printing.html#2953" class="Bound">Δ</a><a id="3136" class="Symbol">)</a> <a id="3138" href="Generic.Semantics.Printing.html#3072" class="Bound">ρ</a><a id="3139" class="Symbol">)</a> <a id="3141" href="Category.Monad.Indexed.html#568" class="Function Operator">&gt;&gt;=</a> <a id="3145" class="Symbol">λ</a> <a id="3147" href="Generic.Semantics.Printing.html#3147" class="Bound">b</a> <a id="3149" class="Symbol">→</a>
                                    <a id="3187" href="Category.Monad.Indexed.html#533" class="Function">return</a> <a id="3194" class="Symbol">((</a><a id="3196" href="Generic.Semantics.Printing.html#1077" class="Field">getN</a> <a id="3201" href="environment.html#556" class="Function Operator">E.&lt;$&gt;</a> <a id="3207" href="Generic.Semantics.Printing.html#3072" class="Bound">ρ</a><a id="3208" class="Symbol">)</a> <a id="3210" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="3212" href="Generic.Semantics.Printing.html#3147" class="Bound">b</a><a id="3213" class="Symbol">)</a>

    <a id="3220" href="Generic.Semantics.Printing.html#3220" class="Function">ih</a> <a id="3223" class="Symbol">:</a> <a id="3225" href="Generic.Semantics.Printing.html#695" class="Function">M</a> <a id="3227" class="Symbol">(</a><a id="3228" href="Generic.Syntax.html#727" class="Function Operator">⟦</a> <a id="3230" href="Generic.Semantics.Printing.html#2533" class="Bound">d</a> <a id="3232" href="Generic.Syntax.html#727" class="Function Operator">⟧</a> <a id="3234" class="Symbol">(</a><a id="3235" href="Generic.Semantics.Printing.html#2088" class="Function">Pieces</a> <a id="3242" href="Generic.Semantics.Printing.html#2533" class="Bound">d</a><a id="3243" class="Symbol">)</a> <a id="3245" href="Generic.Semantics.Printing.html#2741" class="Bound">i</a> <a id="3247" href="Generic.Semantics.Printing.html#2745" class="Bound">Γ</a><a id="3248" class="Symbol">)</a>
    <a id="3254" href="Generic.Semantics.Printing.html#3220" class="Function">ih</a> <a id="3257" class="Symbol">=</a> <a id="3259" href="Generic.Syntax.html#4041" class="Function">S.traverse</a> <a id="3270" href="Category.Monad.Indexed.html#1104" class="Function">rawIApplicative</a> <a id="3286" href="Generic.Semantics.Printing.html#2533" class="Bound">d</a> <a id="3288" class="Symbol">(</a><a id="3289" href="Generic.Syntax.html#2517" class="Function">fmap</a> <a id="3294" href="Generic.Semantics.Printing.html#2533" class="Bound">d</a> <a id="3296" href="Generic.Semantics.Printing.html#2788" class="Function">reify^M</a> <a id="3304" href="Generic.Semantics.Printing.html#2748" class="Bound">v</a><a id="3305" class="Symbol">)</a>

<a id="3308" class="Comment">-- Corollary: a generic printer using a silly name supply</a>

  <a id="3369" href="Generic.Semantics.Printing.html#3369" class="Function">print</a> <a id="3375" class="Symbol">:</a> <a id="3377" href="Generic.Semantics.Printing.html#2209" class="Record">Display</a> <a id="3385" href="Generic.Semantics.Printing.html#2533" class="Bound">d</a> <a id="3387" class="Symbol">→</a> <a id="3389" class="Symbol">{</a><a id="3390" href="Generic.Semantics.Printing.html#3390" class="Bound">i</a> <a id="3392" class="Symbol">:</a> <a id="3394" href="Generic.Semantics.Printing.html#2523" class="Bound">I</a><a id="3395" class="Symbol">}</a> <a id="3397" class="Symbol">→</a> <a id="3399" href="Generic.Syntax.html#1494" class="Function">TM</a> <a id="3402" href="Generic.Semantics.Printing.html#2533" class="Bound">d</a> <a id="3404" href="Generic.Semantics.Printing.html#3390" class="Bound">i</a> <a id="3406" class="Symbol">→</a> <a id="3408" href="Agda.Builtin.String.html#165" class="Postulate">String</a>
  <a id="3417" href="Generic.Semantics.Printing.html#3369" class="Function">print</a> <a id="3423" href="Generic.Semantics.Printing.html#3423" class="Bound">dis</a> <a id="3427" href="Generic.Semantics.Printing.html#3427" class="Bound">t</a> <a id="3429" class="Symbol">=</a> <a id="3431" href="Agda.Builtin.Sigma.html#155" class="Field">proj₁</a> <a id="3437" href="Function.html#1891" class="Function Operator">$</a> <a id="3439" href="Generic.Semantics.Printing.html#1188" class="Field">getP</a> <a id="3444" class="Symbol">(</a><a id="3445" href="Generic.Semantics.html#1037" class="Function">Sem.closed</a> <a id="3456" class="Symbol">(</a><a id="3457" href="Generic.Semantics.Printing.html#2554" class="Function">printing</a> <a id="3466" href="Generic.Semantics.Printing.html#3423" class="Bound">dis</a><a id="3469" class="Symbol">)</a> <a id="3471" href="Generic.Semantics.Printing.html#3427" class="Bound">t</a><a id="3472" class="Symbol">)</a> <a id="3474" href="Generic.Semantics.Printing.html#3752" class="Function">names</a> <a id="3480" class="Keyword">where</a>

    <a id="3491" href="Generic.Semantics.Printing.html#3491" class="Function">alphabetWithSuffix</a> <a id="3510" class="Symbol">:</a> <a id="3512" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="3519" class="Symbol">→</a> <a id="3521" href="Data.List.NonEmpty.html#1135" class="Record">List⁺</a> <a id="3527" href="Agda.Builtin.String.html#165" class="Postulate">String</a>
    <a id="3538" href="Generic.Semantics.Printing.html#3491" class="Function">alphabetWithSuffix</a> <a id="3557" href="Generic.Semantics.Printing.html#3557" class="Bound">suffix</a> <a id="3564" class="Symbol">=</a> <a id="3566" href="Data.List.NonEmpty.html#2254" class="Function">List⁺.map</a> <a id="3576" class="Symbol">(λ</a> <a id="3579" href="Generic.Semantics.Printing.html#3579" class="Bound">c</a> <a id="3581" class="Symbol">→</a> <a id="3583" href="Data.String.Base.html#924" class="Function">fromList</a> <a id="3592" class="Symbol">(</a><a id="3593" href="Generic.Semantics.Printing.html#3579" class="Bound">c</a> <a id="3595" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="3597" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="3599" class="Symbol">)</a> <a id="3601" href="Data.String.Base.html#1089" class="Function Operator">++</a> <a id="3604" href="Generic.Semantics.Printing.html#3557" class="Bound">suffix</a><a id="3610" class="Symbol">)</a>
                              <a id="3642" href="Function.html#1988" class="Function Operator">$′</a> <a id="3645" class="String">&#39;a&#39;</a> <a id="3649" href="Data.List.NonEmpty.html#1185" class="InductiveConstructor Operator">∷</a> <a id="3651" href="Data.String.Base.html#869" class="Function">toList</a> <a id="3658" class="String">&quot;bcdefghijklmnopqrstuvwxyz&quot;</a>

    <a id="3691" href="Generic.Semantics.Printing.html#3691" class="Function">allNats</a> <a id="3699" class="Symbol">:</a> <a id="3701" href="Codata.Stream.html#624" class="Datatype">Stream</a> <a id="3708" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="3710" class="Symbol">_</a>
    <a id="3716" href="Generic.Semantics.Printing.html#3691" class="Function">allNats</a> <a id="3724" class="Symbol">=</a> <a id="3726" href="Codata.Stream.html#2421" class="Function">Stream.iterate</a> <a id="3741" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="3745" class="Number">0</a>

    <a id="3752" href="Generic.Semantics.Printing.html#3752" class="Function">names</a> <a id="3758" class="Symbol">:</a> <a id="3760" href="Codata.Stream.html#624" class="Datatype">Stream</a> <a id="3767" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="3774" class="Symbol">_</a>
    <a id="3780" href="Generic.Semantics.Printing.html#3752" class="Function">names</a> <a id="3786" class="Symbol">=</a> <a id="3788" href="Codata.Stream.html#1484" class="Function">Stream.concat</a>
          <a id="3812" href="Function.html#1988" class="Function Operator">$′</a> <a id="3815" href="Codata.Stream.html#1648" class="Function">Stream.map</a> <a id="3826" href="Generic.Semantics.Printing.html#3491" class="Function">alphabetWithSuffix</a>
          <a id="3855" href="Function.html#1988" class="Function Operator">$′</a> <a id="3858" class="String">&quot;&quot;</a> <a id="3861" href="Codata.Stream.html#674" class="InductiveConstructor Operator">∷</a> <a id="3863" class="Symbol">λ</a> <a id="3865" class="Keyword">where</a> <a id="3871" class="Symbol">.</a><a id="3872" href="Codata.Thunk.html#494" class="Field">force</a> <a id="3878" class="Symbol">→</a> <a id="3880" href="Codata.Stream.html#1648" class="Function">Stream.map</a> <a id="3891" href="Data.Nat.Show.html#951" class="Function">Nat.show</a> <a id="3900" href="Generic.Semantics.Printing.html#3691" class="Function">allNats</a>
</pre></body></html>