<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Generic.Syntax.Bidirectional</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Pragma">--sized-types</a> <a id="34" class="Symbol">#-}</a>

<a id="39" class="Keyword">module</a> <a id="46" href="Generic.Syntax.Bidirectional.html" class="Module">Generic.Syntax.Bidirectional</a> <a id="75" class="Keyword">where</a>

<a id="82" class="Keyword">open</a> <a id="87" class="Keyword">import</a> <a id="94" href="Size.html" class="Module">Size</a>
<a id="99" class="Keyword">open</a> <a id="104" class="Keyword">import</a> <a id="111" href="Data.Product.html" class="Module">Data.Product</a>
<a id="124" class="Keyword">open</a> <a id="129" class="Keyword">import</a> <a id="136" href="Agda.Builtin.List.html" class="Module">Agda.Builtin.List</a>
<a id="154" class="Keyword">open</a> <a id="159" class="Keyword">import</a> <a id="166" href="Agda.Builtin.Equality.html" class="Module">Agda.Builtin.Equality</a>
<a id="188" class="Keyword">open</a> <a id="193" class="Keyword">import</a> <a id="200" href="Function.html" class="Module">Function</a>

<a id="210" class="Keyword">open</a> <a id="215" class="Keyword">import</a> <a id="222" href="Data.Var.html" class="Module">Data.Var</a>
<a id="231" class="Keyword">open</a> <a id="236" class="Keyword">import</a> <a id="243" href="Generic.Syntax.html" class="Module">Generic.Syntax</a>

<a id="259" class="Keyword">open</a> <a id="264" class="Keyword">import</a> <a id="271" href="StateOfTheArt.ACMM.html" class="Module">StateOfTheArt.ACMM</a> <a id="290" class="Keyword">using</a> <a id="296" class="Symbol">(</a><a id="297" href="StateOfTheArt.ACMM.html#347" class="Datatype">Type</a><a id="301" class="Symbol">;</a> <a id="303" href="StateOfTheArt.ACMM.html#366" class="InductiveConstructor">α</a><a id="304" class="Symbol">;</a> <a id="306" href="StateOfTheArt.ACMM.html#380" class="InductiveConstructor Operator">_`→_</a><a id="310" class="Symbol">)</a> <a id="312" class="Keyword">public</a>

<a id="320" class="Comment">-- We have an *untyped* language presented in a bidirectional manner</a>
<a id="389" class="Comment">-- where phases are statically checked</a>


<a id="430" class="Keyword">data</a> <a id="Mode"></a><a id="435" href="Generic.Syntax.Bidirectional.html#435" class="Datatype">Mode</a> <a id="440" class="Symbol">:</a> <a id="442" class="PrimitiveType">Set</a> <a id="446" class="Keyword">where</a>
  <a id="Mode.Check"></a><a id="454" href="Generic.Syntax.Bidirectional.html#454" class="InductiveConstructor">Check</a> <a id="Mode.Infer"></a><a id="460" href="Generic.Syntax.Bidirectional.html#460" class="InductiveConstructor">Infer</a> <a id="466" class="Symbol">:</a> <a id="468" href="Generic.Syntax.Bidirectional.html#435" class="Datatype">Mode</a>

<a id="474" class="Keyword">data</a> <a id="`Bidi"></a><a id="479" href="Generic.Syntax.Bidirectional.html#479" class="Datatype">`Bidi</a> <a id="485" class="Symbol">:</a> <a id="487" class="PrimitiveType">Set</a> <a id="491" class="Keyword">where</a>
  <a id="`Bidi.App"></a><a id="499" href="Generic.Syntax.Bidirectional.html#499" class="InductiveConstructor">App</a> <a id="`Bidi.Lam"></a><a id="503" href="Generic.Syntax.Bidirectional.html#503" class="InductiveConstructor">Lam</a> <a id="`Bidi.Emb"></a><a id="507" href="Generic.Syntax.Bidirectional.html#507" class="InductiveConstructor">Emb</a> <a id="511" class="Symbol">:</a> <a id="513" href="Generic.Syntax.Bidirectional.html#479" class="Datatype">`Bidi</a>
  <a id="`Bidi.Cut"></a><a id="521" href="Generic.Syntax.Bidirectional.html#521" class="InductiveConstructor">Cut</a> <a id="525" class="Symbol">:</a> <a id="527" href="StateOfTheArt.ACMM.html#347" class="Datatype">Type</a> <a id="532" class="Symbol">→</a> <a id="534" href="Generic.Syntax.Bidirectional.html#479" class="Datatype">`Bidi</a>


<a id="542" class="Keyword">private</a>
  <a id="552" class="Keyword">variable</a>
    <a id="565" href="Generic.Syntax.Bidirectional.html#565" class="Generalizable">σ</a> <a id="567" class="Symbol">:</a> <a id="569" href="Generic.Syntax.Bidirectional.html#435" class="Datatype">Mode</a>

<a id="575" class="Comment">-- On top of the traditional Application and Lambda-Abstraction constructors,</a>
<a id="653" class="Comment">-- we have two change of direction ones: `Emb` which takes inferable terms and</a>
<a id="732" class="Comment">-- makes them checkable (it is enough to compare the inferred type to the</a>
<a id="806" class="Comment">-- candidate provided); and `Cut` which takes a checkable term and makes it</a>
<a id="882" class="Comment">-- inferrable thanks to a type-annotation.</a>


<a id="Bidi"></a><a id="927" href="Generic.Syntax.Bidirectional.html#927" class="Function">Bidi</a> <a id="932" class="Symbol">:</a> <a id="934" href="Generic.Syntax.html#503" class="Datatype">Desc</a> <a id="939" href="Generic.Syntax.Bidirectional.html#435" class="Datatype">Mode</a>
<a id="944" href="Generic.Syntax.Bidirectional.html#927" class="Function">Bidi</a>  <a id="950" class="Symbol">=</a>  <a id="953" href="Generic.Syntax.html#533" class="InductiveConstructor">`σ</a> <a id="956" href="Generic.Syntax.Bidirectional.html#479" class="Datatype">`Bidi</a> <a id="962" href="Function.html#1927" class="Function Operator">$</a> <a id="964" class="Symbol">λ</a> <a id="966" class="Keyword">where</a>
  <a id="974" href="Generic.Syntax.Bidirectional.html#499" class="InductiveConstructor">App</a>      <a id="983" class="Symbol">→</a> <a id="985" href="Generic.Syntax.html#575" class="InductiveConstructor">`X</a> <a id="988" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a> <a id="991" href="Generic.Syntax.Bidirectional.html#460" class="InductiveConstructor">Infer</a> <a id="997" class="Symbol">(</a><a id="998" href="Generic.Syntax.html#575" class="InductiveConstructor">`X</a> <a id="1001" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a> <a id="1004" href="Generic.Syntax.Bidirectional.html#454" class="InductiveConstructor">Check</a> <a id="1010" class="Symbol">(</a><a id="1011" href="Generic.Syntax.html#617" class="InductiveConstructor">`∎</a> <a id="1014" href="Generic.Syntax.Bidirectional.html#460" class="InductiveConstructor">Infer</a><a id="1019" class="Symbol">))</a>
  <a id="1024" href="Generic.Syntax.Bidirectional.html#503" class="InductiveConstructor">Lam</a>      <a id="1033" class="Symbol">→</a> <a id="1035" href="Generic.Syntax.html#575" class="InductiveConstructor">`X</a> <a id="1038" class="Symbol">(</a><a id="1039" href="Generic.Syntax.Bidirectional.html#460" class="InductiveConstructor">Infer</a> <a id="1045" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1047" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a><a id="1049" class="Symbol">)</a> <a id="1051" href="Generic.Syntax.Bidirectional.html#454" class="InductiveConstructor">Check</a> <a id="1057" class="Symbol">(</a><a id="1058" href="Generic.Syntax.html#617" class="InductiveConstructor">`∎</a> <a id="1061" href="Generic.Syntax.Bidirectional.html#454" class="InductiveConstructor">Check</a><a id="1066" class="Symbol">)</a>
  <a id="1070" class="Symbol">(</a><a id="1071" href="Generic.Syntax.Bidirectional.html#521" class="InductiveConstructor">Cut</a> <a id="1075" href="Generic.Syntax.Bidirectional.html#1075" class="Bound">σ</a><a id="1076" class="Symbol">)</a>  <a id="1079" class="Symbol">→</a> <a id="1081" href="Generic.Syntax.html#575" class="InductiveConstructor">`X</a> <a id="1084" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a> <a id="1087" href="Generic.Syntax.Bidirectional.html#454" class="InductiveConstructor">Check</a> <a id="1093" class="Symbol">(</a><a id="1094" href="Generic.Syntax.html#617" class="InductiveConstructor">`∎</a> <a id="1097" href="Generic.Syntax.Bidirectional.html#460" class="InductiveConstructor">Infer</a><a id="1102" class="Symbol">)</a>
  <a id="1106" href="Generic.Syntax.Bidirectional.html#507" class="InductiveConstructor">Emb</a>      <a id="1115" class="Symbol">→</a> <a id="1117" href="Generic.Syntax.html#575" class="InductiveConstructor">`X</a> <a id="1120" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a> <a id="1123" href="Generic.Syntax.Bidirectional.html#460" class="InductiveConstructor">Infer</a> <a id="1129" class="Symbol">(</a><a id="1130" href="Generic.Syntax.html#617" class="InductiveConstructor">`∎</a> <a id="1133" href="Generic.Syntax.Bidirectional.html#454" class="InductiveConstructor">Check</a><a id="1138" class="Symbol">)</a>


<a id="1142" class="Keyword">module</a> <a id="PATTERNS"></a><a id="1149" href="Generic.Syntax.Bidirectional.html#1149" class="Module">PATTERNS</a> <a id="1158" class="Keyword">where</a>


  <a id="1168" class="Keyword">pattern</a> <a id="PATTERNS.`app&#39;"></a><a id="1176" href="Generic.Syntax.Bidirectional.html#1176" class="InductiveConstructor">`app&#39;</a> <a id="1182" href="Generic.Syntax.Bidirectional.html#1196" class="Bound">f</a> <a id="1184" href="Generic.Syntax.Bidirectional.html#1200" class="Bound">t</a>  <a id="1187" class="Symbol">=</a> <a id="1189" class="Symbol">(</a><a id="1190" href="Generic.Syntax.Bidirectional.html#499" class="InductiveConstructor">App</a> <a id="1194" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1196" href="Generic.Syntax.Bidirectional.html#1196" class="Bound">f</a> <a id="1198" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1200" href="Generic.Syntax.Bidirectional.html#1200" class="Bound">t</a> <a id="1202" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1204" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="1208" class="Symbol">)</a>
  <a id="1212" class="Keyword">pattern</a> <a id="PATTERNS.`lam&#39;"></a><a id="1220" href="Generic.Syntax.Bidirectional.html#1220" class="InductiveConstructor">`lam&#39;</a> <a id="1226" href="Generic.Syntax.Bidirectional.html#1240" class="Bound">b</a>    <a id="1231" class="Symbol">=</a> <a id="1233" class="Symbol">(</a><a id="1234" href="Generic.Syntax.Bidirectional.html#503" class="InductiveConstructor">Lam</a> <a id="1238" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1240" href="Generic.Syntax.Bidirectional.html#1240" class="Bound">b</a> <a id="1242" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1244" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="1248" class="Symbol">)</a>
  <a id="1252" class="Keyword">pattern</a> <a id="PATTERNS.`cut&#39;"></a><a id="1260" href="Generic.Syntax.Bidirectional.html#1260" class="InductiveConstructor">`cut&#39;</a> <a id="1266" href="Generic.Syntax.Bidirectional.html#1278" class="Bound">σ</a> <a id="1268" href="Generic.Syntax.Bidirectional.html#1282" class="Bound">t</a>  <a id="1271" class="Symbol">=</a> <a id="1273" class="Symbol">(</a><a id="1274" href="Generic.Syntax.Bidirectional.html#521" class="InductiveConstructor">Cut</a> <a id="1278" href="Generic.Syntax.Bidirectional.html#1278" class="Bound">σ</a> <a id="1280" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1282" href="Generic.Syntax.Bidirectional.html#1282" class="Bound">t</a> <a id="1284" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1286" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="1290" class="Symbol">)</a>
  <a id="1294" class="Keyword">pattern</a> <a id="PATTERNS.`emb&#39;"></a><a id="1302" href="Generic.Syntax.Bidirectional.html#1302" class="InductiveConstructor">`emb&#39;</a> <a id="1308" href="Generic.Syntax.Bidirectional.html#1322" class="Bound">t</a>    <a id="1313" class="Symbol">=</a> <a id="1315" class="Symbol">(</a><a id="1316" href="Generic.Syntax.Bidirectional.html#507" class="InductiveConstructor">Emb</a> <a id="1320" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1322" href="Generic.Syntax.Bidirectional.html#1322" class="Bound">t</a> <a id="1324" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1326" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="1330" class="Symbol">)</a>

  <a id="1335" class="Keyword">pattern</a> <a id="PATTERNS.`app"></a><a id="1343" href="Generic.Syntax.Bidirectional.html#1343" class="InductiveConstructor">`app</a> <a id="1348" href="Generic.Syntax.Bidirectional.html#1367" class="Bound">f</a> <a id="1350" href="Generic.Syntax.Bidirectional.html#1369" class="Bound">t</a>  <a id="1353" class="Symbol">=</a> <a id="1355" href="Generic.Syntax.html#1394" class="InductiveConstructor">`con</a> <a id="1360" class="Symbol">(</a><a id="1361" href="Generic.Syntax.Bidirectional.html#1176" class="InductiveConstructor">`app&#39;</a> <a id="1367" href="Generic.Syntax.Bidirectional.html#1367" class="Bound">f</a> <a id="1369" href="Generic.Syntax.Bidirectional.html#1369" class="Bound">t</a><a id="1370" class="Symbol">)</a>
  <a id="1374" class="Keyword">pattern</a> <a id="PATTERNS.`lam"></a><a id="1382" href="Generic.Syntax.Bidirectional.html#1382" class="InductiveConstructor">`lam</a> <a id="1387" href="Generic.Syntax.Bidirectional.html#1406" class="Bound">b</a>    <a id="1392" class="Symbol">=</a> <a id="1394" href="Generic.Syntax.html#1394" class="InductiveConstructor">`con</a> <a id="1399" class="Symbol">(</a><a id="1400" href="Generic.Syntax.Bidirectional.html#1220" class="InductiveConstructor">`lam&#39;</a> <a id="1406" href="Generic.Syntax.Bidirectional.html#1406" class="Bound">b</a><a id="1407" class="Symbol">)</a>
  <a id="1411" class="Keyword">pattern</a> <a id="PATTERNS.`cut"></a><a id="1419" href="Generic.Syntax.Bidirectional.html#1419" class="InductiveConstructor">`cut</a> <a id="1424" href="Generic.Syntax.Bidirectional.html#1443" class="Bound">σ</a> <a id="1426" href="Generic.Syntax.Bidirectional.html#1445" class="Bound">t</a>  <a id="1429" class="Symbol">=</a> <a id="1431" href="Generic.Syntax.html#1394" class="InductiveConstructor">`con</a> <a id="1436" class="Symbol">(</a><a id="1437" href="Generic.Syntax.Bidirectional.html#1260" class="InductiveConstructor">`cut&#39;</a> <a id="1443" href="Generic.Syntax.Bidirectional.html#1443" class="Bound">σ</a> <a id="1445" href="Generic.Syntax.Bidirectional.html#1445" class="Bound">t</a><a id="1446" class="Symbol">)</a>
  <a id="1450" class="Keyword">pattern</a> <a id="PATTERNS.`emb"></a><a id="1458" href="Generic.Syntax.Bidirectional.html#1458" class="InductiveConstructor">`emb</a> <a id="1463" href="Generic.Syntax.Bidirectional.html#1482" class="Bound">t</a>    <a id="1468" class="Symbol">=</a> <a id="1470" href="Generic.Syntax.html#1394" class="InductiveConstructor">`con</a> <a id="1475" class="Symbol">(</a><a id="1476" href="Generic.Syntax.Bidirectional.html#1302" class="InductiveConstructor">`emb&#39;</a> <a id="1482" href="Generic.Syntax.Bidirectional.html#1482" class="Bound">t</a><a id="1483" class="Symbol">)</a>


<a id="id^B"></a><a id="1487" href="Generic.Syntax.Bidirectional.html#1487" class="Function">id^B</a> <a id="1492" class="Symbol">:</a> <a id="1494" href="Generic.Syntax.html#1293" class="Datatype">Tm</a> <a id="1497" href="Generic.Syntax.Bidirectional.html#927" class="Function">Bidi</a> <a id="1502" href="Agda.Builtin.Size.html#275" class="Postulate">∞</a> <a id="1504" href="Generic.Syntax.Bidirectional.html#454" class="InductiveConstructor">Check</a> <a id="1510" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>
<a id="1513" href="Generic.Syntax.Bidirectional.html#1487" class="Function">id^B</a> <a id="1518" class="Symbol">=</a> <a id="1520" href="Generic.Syntax.Bidirectional.html#1382" class="InductiveConstructor">`lam</a> <a id="1525" class="Symbol">(</a><a id="1526" href="Generic.Syntax.Bidirectional.html#1458" class="InductiveConstructor">`emb</a> <a id="1531" class="Symbol">(</a><a id="1532" href="Generic.Syntax.html#1337" class="InductiveConstructor">`var</a> <a id="1537" href="Data.Var.html#640" class="InductiveConstructor">z</a><a id="1538" class="Symbol">))</a>

  <a id="1544" class="Keyword">where</a> <a id="1550" class="Keyword">open</a> <a id="1555" href="Generic.Syntax.Bidirectional.html#1149" class="Module">PATTERNS</a>
</pre></body></html>