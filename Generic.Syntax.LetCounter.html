<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Generic.Syntax.LetCounter</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Pragma">--sized-types</a> <a id="34" class="Symbol">#-}</a>

<a id="39" class="Keyword">module</a> <a id="46" href="Generic.Syntax.LetCounter.html" class="Module">Generic.Syntax.LetCounter</a> <a id="72" class="Keyword">where</a>

<a id="79" class="Keyword">open</a> <a id="84" class="Keyword">import</a> <a id="91" href="Algebra.html" class="Module">Algebra</a>
<a id="99" class="Keyword">open</a> <a id="104" class="Keyword">import</a> <a id="111" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="121" class="Keyword">open</a> <a id="126" class="Keyword">import</a> <a id="133" href="Data.Product.html" class="Module">Data.Product</a>
<a id="146" class="Keyword">open</a> <a id="151" class="Keyword">import</a> <a id="158" href="Data.List.All.html" class="Module">Data.List.All</a>
<a id="172" class="Keyword">open</a> <a id="177" class="Keyword">import</a> <a id="184" href="Agda.Builtin.List.html" class="Module">Agda.Builtin.List</a>
<a id="202" class="Keyword">open</a> <a id="207" class="Keyword">import</a> <a id="214" href="Agda.Builtin.Equality.html" class="Module">Agda.Builtin.Equality</a>
<a id="236" class="Keyword">open</a> <a id="241" class="Keyword">import</a> <a id="248" href="Relation.Unary.html" class="Module">Relation.Unary</a>
<a id="263" class="Keyword">open</a> <a id="268" class="Keyword">import</a> <a id="275" href="Function.html" class="Module">Function</a>

<a id="285" class="Keyword">open</a> <a id="290" class="Keyword">import</a> <a id="297" href="Data.Var.html" class="Module">Data.Var</a>
<a id="306" class="Keyword">open</a> <a id="311" class="Keyword">import</a> <a id="318" href="Generic.Syntax.html" class="Module">Generic.Syntax</a>

<a id="334" class="Keyword">import</a> <a id="341" href="Generic.Syntax.LetBinder.html" class="Module">Generic.Syntax.LetBinder</a> <a id="366" class="Symbol">as</a> <a id="369" class="Module">LetBinder</a>

<a id="380" class="Keyword">data</a> <a id="Counter"></a><a id="385" href="Generic.Syntax.LetCounter.html#385" class="Datatype">Counter</a> <a id="393" class="Symbol">:</a> <a id="395" class="PrimitiveType">Set</a> <a id="399" class="Keyword">where</a>
  <a id="Counter.zero"></a><a id="407" href="Generic.Syntax.LetCounter.html#407" class="InductiveConstructor">zero</a> <a id="412" class="Symbol">:</a> <a id="414" href="Generic.Syntax.LetCounter.html#385" class="Datatype">Counter</a>
  <a id="Counter.one"></a><a id="424" href="Generic.Syntax.LetCounter.html#424" class="InductiveConstructor">one</a>  <a id="429" class="Symbol">:</a> <a id="431" href="Generic.Syntax.LetCounter.html#385" class="Datatype">Counter</a>
  <a id="Counter.many"></a><a id="441" href="Generic.Syntax.LetCounter.html#441" class="InductiveConstructor">many</a> <a id="446" class="Symbol">:</a> <a id="448" href="Generic.Syntax.LetCounter.html#385" class="Datatype">Counter</a>

<a id="_+_"></a><a id="457" href="Generic.Syntax.LetCounter.html#457" class="Function Operator">_+_</a> <a id="461" class="Symbol">:</a> <a id="463" href="Generic.Syntax.LetCounter.html#385" class="Datatype">Counter</a> <a id="471" class="Symbol">→</a> <a id="473" href="Generic.Syntax.LetCounter.html#385" class="Datatype">Counter</a> <a id="481" class="Symbol">→</a> <a id="483" href="Generic.Syntax.LetCounter.html#385" class="Datatype">Counter</a>
<a id="491" href="Generic.Syntax.LetCounter.html#407" class="InductiveConstructor">zero</a> <a id="496" href="Generic.Syntax.LetCounter.html#457" class="Function Operator">+</a> <a id="498" href="Generic.Syntax.LetCounter.html#498" class="Bound">n</a> <a id="500" class="Symbol">=</a> <a id="502" href="Generic.Syntax.LetCounter.html#498" class="Bound">n</a>
<a id="504" href="Generic.Syntax.LetCounter.html#504" class="CatchallClause Bound">m</a><a id="505" class="CatchallClause"> </a><a id="506" href="Generic.Syntax.LetCounter.html#457" class="CatchallClause Function Operator">+</a><a id="507" class="CatchallClause"> </a><a id="508" href="Generic.Syntax.LetCounter.html#407" class="CatchallClause InductiveConstructor">zero</a> <a id="513" class="Symbol">=</a> <a id="515" href="Generic.Syntax.LetCounter.html#504" class="Bound">m</a>
<a id="517" class="CatchallClause Symbol">_</a><a id="518" class="CatchallClause"> </a><a id="519" href="Generic.Syntax.LetCounter.html#457" class="CatchallClause Function Operator">+</a><a id="520" class="CatchallClause"> </a><a id="521" class="CatchallClause Symbol">_</a>    <a id="526" class="Symbol">=</a> <a id="528" href="Generic.Syntax.LetCounter.html#441" class="InductiveConstructor">many</a>

<a id="534" class="Keyword">module</a> <a id="541" href="Generic.Syntax.LetCounter.html#541" class="Module">_</a> <a id="543" class="Symbol">{</a><a id="544" href="Generic.Syntax.LetCounter.html#544" class="Bound">I</a> <a id="546" class="Symbol">:</a> <a id="548" class="PrimitiveType">Set</a><a id="551" class="Symbol">}</a> <a id="553" class="Keyword">where</a>

  <a id="562" href="Generic.Syntax.LetCounter.html#562" class="Function">Count</a> <a id="568" class="Symbol">:</a> <a id="570" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="575" href="Generic.Syntax.LetCounter.html#544" class="Bound">I</a> <a id="577" class="Symbol">→</a> <a id="579" class="PrimitiveType">Set</a>
  <a id="585" href="Generic.Syntax.LetCounter.html#562" class="Function">Count</a> <a id="591" class="Symbol">=</a> <a id="593" href="Data.List.Relation.Unary.All.html#952" class="Datatype">All</a> <a id="597" class="Symbol">(λ</a> <a id="600" href="Generic.Syntax.LetCounter.html#600" class="Bound">_</a> <a id="602" class="Symbol">→</a> <a id="604" href="Generic.Syntax.LetCounter.html#385" class="Datatype">Counter</a><a id="611" class="Symbol">)</a>

  <a id="616" href="Generic.Syntax.LetCounter.html#616" class="Function">zeros</a> <a id="622" class="Symbol">:</a> <a id="624" href="Relation.Unary.html#3195" class="Function">∀[</a> <a id="627" href="Generic.Syntax.LetCounter.html#562" class="Function">Count</a> <a id="633" href="Relation.Unary.html#3195" class="Function">]</a>
  <a id="637" href="Generic.Syntax.LetCounter.html#616" class="Function">zeros</a> <a id="643" class="Symbol">=</a> <a id="645" href="Data.List.Relation.Unary.All.html#1612" class="Function">tabulate</a> <a id="654" class="Symbol">(λ</a> <a id="657" href="Generic.Syntax.LetCounter.html#657" class="Bound">_</a> <a id="659" class="Symbol">→</a> <a id="661" href="Generic.Syntax.LetCounter.html#407" class="InductiveConstructor">zero</a><a id="665" class="Symbol">)</a>

  <a id="670" href="Generic.Syntax.LetCounter.html#670" class="Function">fromVar</a> <a id="678" class="Symbol">:</a> <a id="680" class="Symbol">∀</a> <a id="682" class="Symbol">{</a><a id="683" href="Generic.Syntax.LetCounter.html#683" class="Bound">i</a><a id="684" class="Symbol">}</a> <a id="686" class="Symbol">→</a> <a id="688" href="Relation.Unary.html#3195" class="Function">∀[</a> <a id="691" href="Data.Var.html#616" class="Datatype">Var</a> <a id="695" href="Generic.Syntax.LetCounter.html#683" class="Bound">i</a> <a id="697" href="Relation.Unary.html#4143" class="Function Operator">⇒</a> <a id="699" href="Generic.Syntax.LetCounter.html#562" class="Function">Count</a> <a id="705" href="Relation.Unary.html#3195" class="Function">]</a>
  <a id="709" href="Generic.Syntax.LetCounter.html#670" class="Function">fromVar</a> <a id="717" href="Data.Var.html#640" class="InductiveConstructor">z</a>     <a id="723" class="Symbol">=</a> <a id="725" href="Generic.Syntax.LetCounter.html#424" class="InductiveConstructor">one</a> <a id="729" href="Data.List.Relation.Unary.All.html#1038" class="InductiveConstructor Operator">∷</a> <a id="731" href="Generic.Syntax.LetCounter.html#616" class="Function">zeros</a>
  <a id="739" href="Generic.Syntax.LetCounter.html#670" class="Function">fromVar</a> <a id="747" class="Symbol">(</a><a id="748" href="Data.Var.html#666" class="InductiveConstructor">s</a> <a id="750" href="Generic.Syntax.LetCounter.html#750" class="Bound">v</a><a id="751" class="Symbol">)</a> <a id="753" class="Symbol">=</a> <a id="755" href="Generic.Syntax.LetCounter.html#407" class="InductiveConstructor">zero</a> <a id="760" href="Data.List.Relation.Unary.All.html#1038" class="InductiveConstructor Operator">∷</a> <a id="762" href="Generic.Syntax.LetCounter.html#670" class="Function">fromVar</a> <a id="770" href="Generic.Syntax.LetCounter.html#750" class="Bound">v</a>

  <a id="775" href="Generic.Syntax.LetCounter.html#775" class="Function">merge</a> <a id="781" class="Symbol">:</a> <a id="783" href="Relation.Unary.html#3195" class="Function">∀[</a> <a id="786" href="Generic.Syntax.LetCounter.html#562" class="Function">Count</a> <a id="792" href="Relation.Unary.html#4143" class="Function Operator">⇒</a> <a id="794" href="Generic.Syntax.LetCounter.html#562" class="Function">Count</a> <a id="800" href="Relation.Unary.html#4143" class="Function Operator">⇒</a> <a id="802" href="Generic.Syntax.LetCounter.html#562" class="Function">Count</a> <a id="808" href="Relation.Unary.html#3195" class="Function">]</a>
  <a id="812" href="Generic.Syntax.LetCounter.html#775" class="Function">merge</a> <a id="818" href="Data.List.Relation.Unary.All.html#1021" class="InductiveConstructor">[]</a>       <a id="827" href="Data.List.Relation.Unary.All.html#1021" class="InductiveConstructor">[]</a>       <a id="836" class="Symbol">=</a> <a id="838" href="Data.List.Relation.Unary.All.html#1021" class="InductiveConstructor">[]</a>
  <a id="843" href="Generic.Syntax.LetCounter.html#775" class="Function">merge</a> <a id="849" class="Symbol">(</a><a id="850" href="Generic.Syntax.LetCounter.html#850" class="Bound">m</a> <a id="852" href="Data.List.Relation.Unary.All.html#1038" class="InductiveConstructor Operator">∷</a> <a id="854" href="Generic.Syntax.LetCounter.html#854" class="Bound">cs</a><a id="856" class="Symbol">)</a> <a id="858" class="Symbol">(</a><a id="859" href="Generic.Syntax.LetCounter.html#859" class="Bound">n</a> <a id="861" href="Data.List.Relation.Unary.All.html#1038" class="InductiveConstructor Operator">∷</a> <a id="863" href="Generic.Syntax.LetCounter.html#863" class="Bound">ds</a><a id="865" class="Symbol">)</a> <a id="867" class="Symbol">=</a> <a id="869" href="Generic.Syntax.LetCounter.html#850" class="Bound">m</a> <a id="871" href="Generic.Syntax.LetCounter.html#457" class="Function Operator">+</a> <a id="873" href="Generic.Syntax.LetCounter.html#859" class="Bound">n</a> <a id="875" href="Data.List.Relation.Unary.All.html#1038" class="InductiveConstructor Operator">∷</a> <a id="877" href="Generic.Syntax.LetCounter.html#775" class="Function">merge</a> <a id="883" href="Generic.Syntax.LetCounter.html#854" class="Bound">cs</a> <a id="886" href="Generic.Syntax.LetCounter.html#863" class="Bound">ds</a>

  <a id="892" href="Generic.Syntax.LetCounter.html#892" class="Function">rawMonoid</a> <a id="902" class="Symbol">:</a> <a id="904" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="909" href="Generic.Syntax.LetCounter.html#544" class="Bound">I</a> <a id="911" class="Symbol">→</a> <a id="913" href="Algebra.html#2342" class="Record">RawMonoid</a> <a id="923" class="Symbol">_</a> <a id="925" class="Symbol">_</a>
  <a id="929" href="Generic.Syntax.LetCounter.html#892" class="Function">rawMonoid</a> <a id="939" href="Generic.Syntax.LetCounter.html#939" class="Bound">Γ</a> <a id="941" class="Symbol">=</a> <a id="943" class="Keyword">record</a>
    <a id="954" class="Symbol">{</a> <a id="956" href="Algebra.html#2424" class="Field">Carrier</a> <a id="964" class="Symbol">=</a> <a id="966" href="Generic.Syntax.LetCounter.html#562" class="Function">Count</a> <a id="972" href="Generic.Syntax.LetCounter.html#939" class="Bound">Γ</a>
    <a id="978" class="Symbol">;</a> <a id="980" href="Algebra.html#2444" class="Field Operator">_≈_</a>     <a id="988" class="Symbol">=</a> <a id="990" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">_≡_</a>
    <a id="998" class="Symbol">;</a> <a id="1000" href="Algebra.html#2472" class="Field Operator">_∙_</a>     <a id="1008" class="Symbol">=</a> <a id="1010" href="Generic.Syntax.LetCounter.html#775" class="Function">merge</a>
    <a id="1020" class="Symbol">;</a> <a id="1022" href="Algebra.html#2498" class="Field">ε</a>       <a id="1030" class="Symbol">=</a> <a id="1032" href="Data.List.Relation.Unary.All.html#1612" class="Function">tabulate</a> <a id="1041" class="Symbol">(λ</a> <a id="1044" href="Generic.Syntax.LetCounter.html#1044" class="Bound">_</a> <a id="1046" class="Symbol">→</a> <a id="1048" href="Generic.Syntax.LetCounter.html#407" class="InductiveConstructor">zero</a><a id="1052" class="Symbol">)</a>
    <a id="1058" class="Symbol">}</a>

<a id="1061" class="Keyword">module</a> <a id="1068" href="Generic.Syntax.LetCounter.html#1068" class="Module">_</a> <a id="1070" class="Symbol">{</a><a id="1071" href="Generic.Syntax.LetCounter.html#1071" class="Bound">I</a> <a id="1073" class="Symbol">:</a> <a id="1075" class="PrimitiveType">Set</a><a id="1078" class="Symbol">}</a> <a id="1080" class="Keyword">where</a>

  <a id="1089" href="Generic.Syntax.LetCounter.html#1089" class="Function">Let</a> <a id="1093" class="Symbol">:</a> <a id="1095" href="Generic.Syntax.html#497" class="Datatype">Desc</a> <a id="1100" href="Generic.Syntax.LetCounter.html#1071" class="Bound">I</a>
  <a id="1104" href="Generic.Syntax.LetCounter.html#1089" class="Function">Let</a> <a id="1108" class="Symbol">=</a> <a id="1110" href="Generic.Syntax.html#527" class="InductiveConstructor">`σ</a> <a id="1113" href="Generic.Syntax.LetCounter.html#385" class="Datatype">Counter</a> <a id="1121" href="Function.html#1927" class="Function Operator">$</a> <a id="1123" class="Symbol">λ</a> <a id="1125" href="Generic.Syntax.LetCounter.html#1125" class="Bound">_</a> <a id="1127" class="Symbol">→</a> <a id="1129" href="Generic.Syntax.LetBinder.html#385" class="Function">LetBinder.Let</a>

<a id="1144" class="Keyword">pattern</a> <a id="`IN&#39;"></a><a id="1152" href="Generic.Syntax.LetCounter.html#1152" class="InductiveConstructor">`IN&#39;</a> <a id="1157" href="Generic.Syntax.LetCounter.html#1168" class="Bound">e</a> <a id="1159" href="Generic.Syntax.LetCounter.html#1172" class="Bound">t</a> <a id="1161" class="Symbol">=</a> <a id="1163" class="Symbol">(_</a> <a id="1166" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1168" href="Generic.Syntax.LetCounter.html#1168" class="Bound">e</a> <a id="1170" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1172" href="Generic.Syntax.LetCounter.html#1172" class="Bound">t</a> <a id="1174" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1176" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="1180" class="Symbol">)</a>
<a id="1182" class="Keyword">pattern</a> <a id="`IN"></a><a id="1190" href="Generic.Syntax.LetCounter.html#1190" class="InductiveConstructor">`IN</a>  <a id="1195" href="Generic.Syntax.LetCounter.html#1212" class="Bound">e</a> <a id="1197" href="Generic.Syntax.LetCounter.html#1214" class="Bound">t</a> <a id="1199" class="Symbol">=</a> <a id="1201" href="Generic.Syntax.html#1338" class="InductiveConstructor">`con</a> <a id="1206" class="Symbol">(</a><a id="1207" href="Generic.Syntax.LetCounter.html#1152" class="InductiveConstructor">`IN&#39;</a> <a id="1212" href="Generic.Syntax.LetCounter.html#1212" class="Bound">e</a> <a id="1214" href="Generic.Syntax.LetCounter.html#1214" class="Bound">t</a><a id="1215" class="Symbol">)</a>

<a id="1218" class="Keyword">module</a> <a id="1225" href="Generic.Syntax.LetCounter.html#1225" class="Module">_</a> <a id="1227" class="Symbol">{</a><a id="1228" href="Generic.Syntax.LetCounter.html#1228" class="Bound">I</a> <a id="1230" class="Symbol">:</a> <a id="1232" class="PrimitiveType">Set</a><a id="1235" class="Symbol">}</a> <a id="1237" class="Symbol">{</a><a id="1238" href="Generic.Syntax.LetCounter.html#1238" class="Bound">d</a> <a id="1240" class="Symbol">:</a> <a id="1242" href="Generic.Syntax.html#497" class="Datatype">Desc</a> <a id="1247" href="Generic.Syntax.LetCounter.html#1228" class="Bound">I</a><a id="1248" class="Symbol">}</a> <a id="1250" class="Keyword">where</a>

  <a id="1259" href="Generic.Syntax.LetCounter.html#1259" class="Function">embed</a> <a id="1265" class="Symbol">:</a> <a id="1267" class="Symbol">∀</a> <a id="1269" class="Symbol">{</a><a id="1270" href="Generic.Syntax.LetCounter.html#1270" class="Bound">i</a> <a id="1272" href="Generic.Syntax.LetCounter.html#1272" class="Bound">σ</a><a id="1273" class="Symbol">}</a> <a id="1275" class="Symbol">→</a> <a id="1277" href="Relation.Unary.html#3195" class="Function">∀[</a> <a id="1280" href="Generic.Syntax.html#1237" class="Datatype">Tm</a> <a id="1283" href="Generic.Syntax.LetCounter.html#1238" class="Bound">d</a> <a id="1285" href="Generic.Syntax.LetCounter.html#1270" class="Bound">i</a> <a id="1287" href="Generic.Syntax.LetCounter.html#1272" class="Bound">σ</a> <a id="1289" href="Relation.Unary.html#4143" class="Function Operator">⇒</a> <a id="1291" href="Generic.Syntax.html#1237" class="Datatype">Tm</a> <a id="1294" class="Symbol">(</a><a id="1295" href="Generic.Syntax.LetCounter.html#1238" class="Bound">d</a> <a id="1297" href="Generic.Syntax.html#1777" class="Function Operator">`+</a> <a id="1300" href="Generic.Syntax.LetCounter.html#1089" class="Function">Let</a><a id="1303" class="Symbol">)</a> <a id="1305" href="Generic.Syntax.LetCounter.html#1270" class="Bound">i</a> <a id="1307" href="Generic.Syntax.LetCounter.html#1272" class="Bound">σ</a> <a id="1309" href="Relation.Unary.html#3195" class="Function">]</a>
  <a id="1313" href="Generic.Syntax.LetCounter.html#1259" class="Function">embed</a> <a id="1319" class="Symbol">=</a> <a id="1321" href="Generic.Syntax.html#5047" class="Function">map^Tm</a> <a id="1328" class="Symbol">(</a><a id="1329" href="Generic.Syntax.html#4934" class="InductiveConstructor">MkDescMorphism</a> <a id="1344" class="Symbol">(</a><a id="1345" href="Agda.Builtin.Bool.html#160" class="InductiveConstructor">true</a> <a id="1350" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,_</a><a id="1352" class="Symbol">))</a>

</pre></body></html>