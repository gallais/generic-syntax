<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Generic.Syntax.LetCounter</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Pragma">--sized-types</a> <a id="34" class="Symbol">#-}</a>

<a id="39" class="Keyword">module</a> <a id="46" href="Generic.Syntax.LetCounter.html" class="Module">Generic.Syntax.LetCounter</a> <a id="72" class="Keyword">where</a>

<a id="79" class="Keyword">open</a> <a id="84" class="Keyword">import</a> <a id="91" href="Algebra.html" class="Module">Algebra</a>
<a id="99" class="Keyword">open</a> <a id="104" class="Keyword">import</a> <a id="111" href="Algebra.Structures.html" class="Module">Algebra.Structures</a>
<a id="130" class="Keyword">open</a> <a id="135" class="Keyword">import</a> <a id="142" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="152" class="Keyword">open</a> <a id="157" class="Keyword">import</a> <a id="164" href="Data.List.Relation.Unary.All.html" class="Module">Data.List.Relation.Unary.All</a> <a id="193" class="Symbol">as</a> <a id="196" class="Module">All</a>
<a id="200" class="Keyword">open</a> <a id="205" class="Keyword">import</a> <a id="212" href="Data.Product.html" class="Module">Data.Product</a> <a id="225" class="Keyword">using</a> <a id="231" class="Symbol">(</a><a id="232" href="Data.Product.html#1167" class="Function Operator">_×_</a><a id="235" class="Symbol">;</a> <a id="237" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="240" class="Symbol">)</a>
<a id="242" class="Keyword">open</a> <a id="247" class="Keyword">import</a> <a id="254" href="Agda.Builtin.List.html" class="Module">Agda.Builtin.List</a>
<a id="272" class="Keyword">open</a> <a id="277" class="Keyword">import</a> <a id="284" href="Agda.Builtin.Equality.html" class="Module">Agda.Builtin.Equality</a>
<a id="306" class="Keyword">open</a> <a id="311" class="Keyword">import</a> <a id="318" href="Relation.Unary.html" class="Module">Relation.Unary</a>
<a id="333" class="Keyword">open</a> <a id="338" class="Keyword">import</a> <a id="345" href="Function.html" class="Module">Function</a>

<a id="355" class="Keyword">open</a> <a id="360" class="Keyword">import</a> <a id="367" href="Data.Var.html" class="Module">Data.Var</a>
<a id="376" class="Keyword">open</a> <a id="381" class="Keyword">import</a> <a id="388" href="Generic.Syntax.html" class="Module">Generic.Syntax</a>

<a id="404" class="Keyword">open</a> <a id="409" class="Keyword">import</a> <a id="416" href="Generic.Syntax.LetBinder.html" class="Module">Generic.Syntax.LetBinder</a> <a id="441" class="Keyword">using</a> <a id="447" class="Symbol">(</a><a id="448" href="Generic.Syntax.LetBinder.html#385" class="Function">Let</a><a id="451" class="Symbol">)</a>

<a id="454" class="Keyword">module</a> <a id="461" href="Generic.Syntax.LetCounter.html#461" class="Module">_</a> <a id="463" class="Symbol">{</a><a id="464" href="Generic.Syntax.LetCounter.html#464" class="Bound">a</a><a id="465" class="Symbol">}</a> <a id="467" class="Symbol">{</a><a id="468" href="Generic.Syntax.LetCounter.html#468" class="Bound">A</a> <a id="470" class="Symbol">:</a> <a id="472" class="PrimitiveType">Set</a> <a id="476" href="Generic.Syntax.LetCounter.html#464" class="Bound">a</a><a id="477" class="Symbol">}</a> <a id="479" class="Symbol">(</a><a id="480" href="Generic.Syntax.LetCounter.html#480" class="Bound">expensive</a> <a id="490" class="Symbol">:</a> <a id="492" href="Generic.Syntax.LetCounter.html#468" class="Bound">A</a><a id="493" class="Symbol">)</a> <a id="495" class="Keyword">where</a>

<a id="502" class="Comment">-- inlining is hard</a>

  <a id="525" href="Generic.Syntax.LetCounter.html#525" class="Function">_</a> <a id="527" class="Symbol">:</a> <a id="529" href="Generic.Syntax.LetCounter.html#468" class="Bound">A</a> <a id="531" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="533" href="Generic.Syntax.LetCounter.html#468" class="Bound">A</a>
  <a id="537" class="Comment">-- here we better not inline x (but it&#39;s fine to inline y)</a>

  <a id="599" class="Symbol">_</a> <a id="601" class="Symbol">=</a>  <a id="604" class="Keyword">let</a> <a id="608" href="Generic.Syntax.LetCounter.html#608" class="Bound">x</a> <a id="610" class="Symbol">=</a> <a id="612" href="Generic.Syntax.LetCounter.html#480" class="Bound">expensive</a>  <a id="623" class="Keyword">in</a>
       <a id="633" class="Keyword">let</a> <a id="637" href="Generic.Syntax.LetCounter.html#637" class="Bound">y</a> <a id="639" class="Symbol">=</a> <a id="641" class="Symbol">(</a><a id="642" href="Generic.Syntax.LetCounter.html#608" class="Bound">x</a> <a id="644" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="646" href="Generic.Syntax.LetCounter.html#608" class="Bound">x</a><a id="647" class="Symbol">)</a>    <a id="652" class="Keyword">in</a>
       <a id="662" href="Generic.Syntax.LetCounter.html#637" class="Bound">y</a>

  <a id="667" href="Generic.Syntax.LetCounter.html#667" class="Function">_</a> <a id="669" class="Symbol">:</a> <a id="671" href="Generic.Syntax.LetCounter.html#468" class="Bound">A</a>
  <a id="675" class="Comment">-- here on the other hand we can inline all the lets!</a>

  <a id="732" class="Symbol">_</a> <a id="734" class="Symbol">=</a>  <a id="737" class="Keyword">let</a> <a id="741" href="Generic.Syntax.LetCounter.html#741" class="Bound">x</a> <a id="743" class="Symbol">=</a> <a id="745" href="Generic.Syntax.LetCounter.html#480" class="Bound">expensive</a>  <a id="756" class="Keyword">in</a>
       <a id="766" class="Keyword">let</a> <a id="770" href="Generic.Syntax.LetCounter.html#770" class="Bound">y</a> <a id="772" class="Symbol">=</a> <a id="774" class="Symbol">(</a><a id="775" href="Generic.Syntax.LetCounter.html#741" class="Bound">x</a> <a id="777" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="779" href="Generic.Syntax.LetCounter.html#741" class="Bound">x</a><a id="780" class="Symbol">)</a>    <a id="785" class="Keyword">in</a>
       <a id="795" href="Generic.Syntax.LetCounter.html#741" class="Bound">x</a>

<a id="798" class="Keyword">data</a> <a id="Counter"></a><a id="803" href="Generic.Syntax.LetCounter.html#803" class="Datatype">Counter</a> <a id="811" class="Symbol">:</a> <a id="813" class="PrimitiveType">Set</a> <a id="817" class="Keyword">where</a>
  <a id="Counter.zero"></a><a id="825" href="Generic.Syntax.LetCounter.html#825" class="InductiveConstructor">zero</a>  <a id="831" class="Symbol">:</a> <a id="833" href="Generic.Syntax.LetCounter.html#803" class="Datatype">Counter</a>
  <a id="Counter.one"></a><a id="843" href="Generic.Syntax.LetCounter.html#843" class="InductiveConstructor">one</a>   <a id="849" class="Symbol">:</a> <a id="851" href="Generic.Syntax.LetCounter.html#803" class="Datatype">Counter</a>
  <a id="Counter.many"></a><a id="861" href="Generic.Syntax.LetCounter.html#861" class="InductiveConstructor">many</a>  <a id="867" class="Symbol">:</a> <a id="869" href="Generic.Syntax.LetCounter.html#803" class="Datatype">Counter</a>

<a id="_+_"></a><a id="878" href="Generic.Syntax.LetCounter.html#878" class="Function Operator">_+_</a> <a id="882" class="Symbol">:</a> <a id="884" href="Generic.Syntax.LetCounter.html#803" class="Datatype">Counter</a> <a id="892" class="Symbol">→</a> <a id="894" href="Generic.Syntax.LetCounter.html#803" class="Datatype">Counter</a> <a id="902" class="Symbol">→</a> <a id="904" href="Generic.Syntax.LetCounter.html#803" class="Datatype">Counter</a>
<a id="912" href="Generic.Syntax.LetCounter.html#825" class="InductiveConstructor">zero</a>  <a id="918" href="Generic.Syntax.LetCounter.html#878" class="Function Operator">+</a> <a id="920" href="Generic.Syntax.LetCounter.html#920" class="Bound">n</a>     <a id="926" class="Symbol">=</a> <a id="928" href="Generic.Syntax.LetCounter.html#920" class="Bound">n</a>
<a id="930" href="Generic.Syntax.LetCounter.html#930" class="CatchallClause Bound">m</a><a id="931" class="CatchallClause">     </a><a id="936" href="Generic.Syntax.LetCounter.html#878" class="CatchallClause Function Operator">+</a><a id="937" class="CatchallClause"> </a><a id="938" href="Generic.Syntax.LetCounter.html#825" class="CatchallClause InductiveConstructor">zero</a>  <a id="944" class="Symbol">=</a> <a id="946" href="Generic.Syntax.LetCounter.html#930" class="Bound">m</a>
<a id="948" class="CatchallClause Symbol">_</a><a id="949" class="CatchallClause">     </a><a id="954" href="Generic.Syntax.LetCounter.html#878" class="CatchallClause Function Operator">+</a><a id="955" class="CatchallClause"> </a><a id="956" class="CatchallClause Symbol">_</a>     <a id="962" class="Symbol">=</a> <a id="964" href="Generic.Syntax.LetCounter.html#861" class="InductiveConstructor">many</a>

<a id="_*_"></a><a id="970" href="Generic.Syntax.LetCounter.html#970" class="Function Operator">_*_</a> <a id="974" class="Symbol">:</a> <a id="976" href="Generic.Syntax.LetCounter.html#803" class="Datatype">Counter</a> <a id="984" class="Symbol">→</a> <a id="986" href="Generic.Syntax.LetCounter.html#803" class="Datatype">Counter</a> <a id="994" class="Symbol">→</a> <a id="996" href="Generic.Syntax.LetCounter.html#803" class="Datatype">Counter</a>
<a id="1004" href="Generic.Syntax.LetCounter.html#825" class="InductiveConstructor">zero</a>  <a id="1010" href="Generic.Syntax.LetCounter.html#970" class="Function Operator">*</a> <a id="1012" href="Generic.Syntax.LetCounter.html#1012" class="Bound">n</a>     <a id="1018" class="Symbol">=</a> <a id="1020" href="Generic.Syntax.LetCounter.html#825" class="InductiveConstructor">zero</a>
<a id="1025" href="Generic.Syntax.LetCounter.html#1025" class="CatchallClause Bound">m</a><a id="1026" class="CatchallClause">     </a><a id="1031" href="Generic.Syntax.LetCounter.html#970" class="CatchallClause Function Operator">*</a><a id="1032" class="CatchallClause"> </a><a id="1033" href="Generic.Syntax.LetCounter.html#825" class="CatchallClause InductiveConstructor">zero</a>  <a id="1039" class="Symbol">=</a> <a id="1041" href="Generic.Syntax.LetCounter.html#825" class="InductiveConstructor">zero</a>
<a id="1046" href="Generic.Syntax.LetCounter.html#843" class="CatchallClause InductiveConstructor">one</a><a id="1049" class="CatchallClause">   </a><a id="1052" href="Generic.Syntax.LetCounter.html#970" class="CatchallClause Function Operator">*</a><a id="1053" class="CatchallClause"> </a><a id="1054" href="Generic.Syntax.LetCounter.html#1054" class="CatchallClause Bound">n</a>     <a id="1060" class="Symbol">=</a> <a id="1062" href="Generic.Syntax.LetCounter.html#1054" class="Bound">n</a>
<a id="1064" href="Generic.Syntax.LetCounter.html#1064" class="CatchallClause Bound">m</a><a id="1065" class="CatchallClause">     </a><a id="1070" href="Generic.Syntax.LetCounter.html#970" class="CatchallClause Function Operator">*</a><a id="1071" class="CatchallClause"> </a><a id="1072" href="Generic.Syntax.LetCounter.html#843" class="CatchallClause InductiveConstructor">one</a>   <a id="1078" class="Symbol">=</a> <a id="1080" href="Generic.Syntax.LetCounter.html#1064" class="Bound">m</a>
<a id="1082" href="Generic.Syntax.LetCounter.html#861" class="InductiveConstructor">many</a>  <a id="1088" href="Generic.Syntax.LetCounter.html#970" class="Function Operator">*</a> <a id="1090" href="Generic.Syntax.LetCounter.html#861" class="InductiveConstructor">many</a>  <a id="1096" class="Symbol">=</a> <a id="1098" href="Generic.Syntax.LetCounter.html#861" class="InductiveConstructor">many</a>


<a id="1105" class="Keyword">module</a> <a id="1112" href="Generic.Syntax.LetCounter.html#1112" class="Module">_</a> <a id="1114" class="Symbol">{</a><a id="1115" href="Generic.Syntax.LetCounter.html#1115" class="Bound">I</a> <a id="1117" class="Symbol">:</a> <a id="1119" class="PrimitiveType">Set</a><a id="1122" class="Symbol">}</a> <a id="1124" class="Keyword">where</a>

  <a id="1133" class="Keyword">private</a>
    <a id="1145" class="Keyword">variable</a>
      <a id="1160" href="Generic.Syntax.LetCounter.html#1160" class="Generalizable">σ</a> <a id="1162" class="Symbol">:</a> <a id="1164" href="Generic.Syntax.LetCounter.html#1115" class="Bound">I</a>


  <a id="1170" href="Generic.Syntax.LetCounter.html#1170" class="Function">Count</a> <a id="1176" class="Symbol">:</a> <a id="1178" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1183" href="Generic.Syntax.LetCounter.html#1115" class="Bound">I</a> <a id="1185" class="Symbol">→</a> <a id="1187" class="PrimitiveType">Set</a>
  <a id="1193" href="Generic.Syntax.LetCounter.html#1170" class="Function">Count</a> <a id="1199" class="Symbol">=</a> <a id="1201" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="1205" class="Symbol">(</a><a id="1206" href="Function.Base.html#636" class="Function">const</a> <a id="1212" href="Generic.Syntax.LetCounter.html#803" class="Datatype">Counter</a><a id="1219" class="Symbol">)</a>

  <a id="1224" href="Generic.Syntax.LetCounter.html#1224" class="Function">zeros</a> <a id="1230" class="Symbol">:</a> <a id="1232" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="1235" href="Generic.Syntax.LetCounter.html#1170" class="Function">Count</a> <a id="1241" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="1245" href="Generic.Syntax.LetCounter.html#1224" class="Function">zeros</a> <a id="1251" class="Symbol">{</a><a id="1252" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="1254" class="Symbol">}</a>     <a id="1260" class="Symbol">=</a> <a id="1262" href="Data.List.Relation.Unary.All.html#1507" class="InductiveConstructor">[]</a>
  <a id="1267" href="Generic.Syntax.LetCounter.html#1224" class="Function">zeros</a> <a id="1273" class="Symbol">{</a><a id="1274" href="Generic.Syntax.LetCounter.html#1274" class="Bound">σ</a> <a id="1276" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1278" href="Generic.Syntax.LetCounter.html#1278" class="Bound">Γ</a><a id="1279" class="Symbol">}</a>  <a id="1282" class="Symbol">=</a> <a id="1284" href="Generic.Syntax.LetCounter.html#825" class="InductiveConstructor">zero</a> <a id="1289" href="Data.List.Relation.Unary.All.html#1524" class="InductiveConstructor Operator">∷</a> <a id="1291" href="Generic.Syntax.LetCounter.html#1224" class="Function">zeros</a>

  <a id="1300" href="Generic.Syntax.LetCounter.html#1300" class="Function">fromVar</a> <a id="1308" class="Symbol">:</a> <a id="1310" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="1313" href="Data.Var.html#636" class="Datatype">Var</a> <a id="1317" href="Generic.Syntax.LetCounter.html#1160" class="Generalizable">σ</a> <a id="1319" href="Relation.Unary.html#4338" class="Function Operator">⇒</a> <a id="1321" href="Generic.Syntax.LetCounter.html#1170" class="Function">Count</a> <a id="1327" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="1331" href="Generic.Syntax.LetCounter.html#1300" class="Function">fromVar</a> <a id="1339" href="Data.Var.html#660" class="InductiveConstructor">z</a>      <a id="1346" class="Symbol">=</a> <a id="1348" href="Generic.Syntax.LetCounter.html#843" class="InductiveConstructor">one</a> <a id="1352" href="Data.List.Relation.Unary.All.html#1524" class="InductiveConstructor Operator">∷</a> <a id="1354" href="Generic.Syntax.LetCounter.html#1224" class="Function">zeros</a>
  <a id="1362" href="Generic.Syntax.LetCounter.html#1300" class="Function">fromVar</a> <a id="1370" class="Symbol">(</a><a id="1371" href="Data.Var.html#686" class="InductiveConstructor">s</a> <a id="1373" href="Generic.Syntax.LetCounter.html#1373" class="Bound">v</a><a id="1374" class="Symbol">)</a>  <a id="1377" class="Symbol">=</a> <a id="1379" href="Generic.Syntax.LetCounter.html#825" class="InductiveConstructor">zero</a> <a id="1384" href="Data.List.Relation.Unary.All.html#1524" class="InductiveConstructor Operator">∷</a> <a id="1386" href="Generic.Syntax.LetCounter.html#1300" class="Function">fromVar</a> <a id="1394" href="Generic.Syntax.LetCounter.html#1373" class="Bound">v</a>



  <a id="1401" href="Generic.Syntax.LetCounter.html#1401" class="Function">merge</a> <a id="1407" class="Symbol">:</a> <a id="1409" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="1412" href="Generic.Syntax.LetCounter.html#1170" class="Function">Count</a> <a id="1418" href="Relation.Unary.html#4338" class="Function Operator">⇒</a> <a id="1420" href="Generic.Syntax.LetCounter.html#1170" class="Function">Count</a> <a id="1426" href="Relation.Unary.html#4338" class="Function Operator">⇒</a> <a id="1428" href="Generic.Syntax.LetCounter.html#1170" class="Function">Count</a> <a id="1434" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="1438" href="Generic.Syntax.LetCounter.html#1401" class="Function">merge</a> <a id="1444" href="Data.List.Relation.Unary.All.html#1507" class="InductiveConstructor">[]</a>        <a id="1454" href="Data.List.Relation.Unary.All.html#1507" class="InductiveConstructor">[]</a>        <a id="1464" class="Symbol">=</a> <a id="1466" href="Data.List.Relation.Unary.All.html#1507" class="InductiveConstructor">[]</a>
  <a id="1471" href="Generic.Syntax.LetCounter.html#1401" class="Function">merge</a> <a id="1477" class="Symbol">(</a><a id="1478" href="Generic.Syntax.LetCounter.html#1478" class="Bound">m</a> <a id="1480" href="Data.List.Relation.Unary.All.html#1524" class="InductiveConstructor Operator">∷</a> <a id="1482" href="Generic.Syntax.LetCounter.html#1482" class="Bound">cs</a><a id="1484" class="Symbol">)</a>  <a id="1487" class="Symbol">(</a><a id="1488" href="Generic.Syntax.LetCounter.html#1488" class="Bound">n</a> <a id="1490" href="Data.List.Relation.Unary.All.html#1524" class="InductiveConstructor Operator">∷</a> <a id="1492" href="Generic.Syntax.LetCounter.html#1492" class="Bound">ds</a><a id="1494" class="Symbol">)</a>  <a id="1497" class="Symbol">=</a>
    <a id="1503" class="Symbol">(</a><a id="1504" href="Generic.Syntax.LetCounter.html#1478" class="Bound">m</a> <a id="1506" href="Generic.Syntax.LetCounter.html#878" class="Function Operator">+</a> <a id="1508" href="Generic.Syntax.LetCounter.html#1488" class="Bound">n</a><a id="1509" class="Symbol">)</a> <a id="1511" href="Data.List.Relation.Unary.All.html#1524" class="InductiveConstructor Operator">∷</a> <a id="1513" href="Generic.Syntax.LetCounter.html#1401" class="Function">merge</a> <a id="1519" href="Generic.Syntax.LetCounter.html#1482" class="Bound">cs</a> <a id="1522" href="Generic.Syntax.LetCounter.html#1492" class="Bound">ds</a>



  <a id="1530" href="Generic.Syntax.LetCounter.html#1530" class="Function">control</a> <a id="1538" class="Symbol">:</a> <a id="1540" href="Generic.Syntax.LetCounter.html#803" class="Datatype">Counter</a> <a id="1548" class="Symbol">→</a> <a id="1550" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="1553" href="Generic.Syntax.LetCounter.html#1170" class="Function">Count</a> <a id="1559" href="Relation.Unary.html#4338" class="Function Operator">⇒</a> <a id="1561" href="Generic.Syntax.LetCounter.html#1170" class="Function">Count</a> <a id="1567" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="1571" href="Generic.Syntax.LetCounter.html#1530" class="Function">control</a> <a id="1579" href="Generic.Syntax.LetCounter.html#825" class="InductiveConstructor">zero</a>  <a id="1585" href="Generic.Syntax.LetCounter.html#1585" class="Bound">cs</a> <a id="1588" class="Symbol">=</a> <a id="1590" href="Generic.Syntax.LetCounter.html#1224" class="Function">zeros</a>
  <a id="1598" href="Generic.Syntax.LetCounter.html#1530" class="Function">control</a> <a id="1606" href="Generic.Syntax.LetCounter.html#843" class="InductiveConstructor">one</a>   <a id="1612" href="Generic.Syntax.LetCounter.html#1612" class="Bound">cs</a> <a id="1615" class="Symbol">=</a> <a id="1617" href="Generic.Syntax.LetCounter.html#1612" class="Bound">cs</a> <a id="1620" class="Comment">-- inlined</a>
  <a id="1633" href="Generic.Syntax.LetCounter.html#1530" class="Function">control</a> <a id="1641" href="Generic.Syntax.LetCounter.html#861" class="InductiveConstructor">many</a>  <a id="1647" href="Generic.Syntax.LetCounter.html#1647" class="Bound">cs</a> <a id="1650" class="Symbol">=</a> <a id="1652" href="Generic.Syntax.LetCounter.html#1647" class="Bound">cs</a> <a id="1655" class="Comment">-- not inlined</a>



  <a id="1675" href="Generic.Syntax.LetCounter.html#1675" class="Function">scale</a> <a id="1681" class="Symbol">:</a> <a id="1683" href="Generic.Syntax.LetCounter.html#803" class="Datatype">Counter</a> <a id="1691" class="Symbol">→</a> <a id="1693" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="1696" href="Generic.Syntax.LetCounter.html#1170" class="Function">Count</a> <a id="1702" href="Relation.Unary.html#4338" class="Function Operator">⇒</a> <a id="1704" href="Generic.Syntax.LetCounter.html#1170" class="Function">Count</a> <a id="1710" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="1714" href="Generic.Syntax.LetCounter.html#1675" class="Function">scale</a> <a id="1720" href="Generic.Syntax.LetCounter.html#825" class="InductiveConstructor">zero</a>  <a id="1726" href="Generic.Syntax.LetCounter.html#1726" class="Bound">cs</a> <a id="1729" class="Symbol">=</a> <a id="1731" href="Generic.Syntax.LetCounter.html#1224" class="Function">zeros</a>
  <a id="1739" href="Generic.Syntax.LetCounter.html#1675" class="Function">scale</a> <a id="1745" href="Generic.Syntax.LetCounter.html#843" class="InductiveConstructor">one</a>   <a id="1751" href="Generic.Syntax.LetCounter.html#1751" class="Bound">cs</a> <a id="1754" class="Symbol">=</a> <a id="1756" href="Generic.Syntax.LetCounter.html#1751" class="Bound">cs</a>
  <a id="1761" href="Generic.Syntax.LetCounter.html#1675" class="CatchallClause Function">scale</a><a id="1766" class="CatchallClause"> </a><a id="1767" href="Generic.Syntax.LetCounter.html#1767" class="CatchallClause Bound">k</a><a id="1768" class="CatchallClause">     </a><a id="1773" href="Generic.Syntax.LetCounter.html#1773" class="CatchallClause Bound">cs</a> <a id="1776" class="Symbol">=</a> <a id="1778" href="Data.List.Relation.Unary.All.html#2935" class="Function">map</a> <a id="1782" class="Symbol">(</a><a id="1783" href="Generic.Syntax.LetCounter.html#1767" class="Bound">k</a> <a id="1785" href="Generic.Syntax.LetCounter.html#970" class="Function Operator">*_</a><a id="1787" class="Symbol">)</a> <a id="1789" href="Generic.Syntax.LetCounter.html#1773" class="Bound">cs</a>



  <a id="1797" href="Generic.Syntax.LetCounter.html#1797" class="Function">rawMonoid</a> <a id="1807" class="Symbol">:</a> <a id="1809" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1814" href="Generic.Syntax.LetCounter.html#1115" class="Bound">I</a> <a id="1816" class="Symbol">→</a> <a id="1818" href="Algebra.Bundles.html#4104" class="Record">RawMonoid</a> <a id="1828" class="Symbol">_</a> <a id="1830" class="Symbol">_</a>
  <a id="1834" href="Generic.Syntax.LetCounter.html#1797" class="Function">rawMonoid</a> <a id="1844" href="Generic.Syntax.LetCounter.html#1844" class="Bound">Γ</a> <a id="1846" class="Symbol">=</a> <a id="1848" class="Keyword">record</a>
    <a id="1859" class="Symbol">{</a> <a id="1861" href="Algebra.Bundles.html#4186" class="Field">Carrier</a> <a id="1869" class="Symbol">=</a> <a id="1871" href="Generic.Syntax.LetCounter.html#1170" class="Function">Count</a> <a id="1877" href="Generic.Syntax.LetCounter.html#1844" class="Bound">Γ</a>
    <a id="1883" class="Symbol">;</a> <a id="1885" href="Algebra.Bundles.html#4206" class="Field Operator">_≈_</a>     <a id="1893" class="Symbol">=</a> <a id="1895" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a>
    <a id="1903" class="Symbol">;</a> <a id="1905" href="Algebra.Bundles.html#4234" class="Field Operator">_∙_</a>     <a id="1913" class="Symbol">=</a> <a id="1915" href="Generic.Syntax.LetCounter.html#1401" class="Function">merge</a>
    <a id="1925" class="Symbol">;</a> <a id="1927" href="Algebra.Bundles.html#4260" class="Field">ε</a>       <a id="1935" class="Symbol">=</a> <a id="1937" href="Data.List.Relation.Unary.All.html#3725" class="Function">tabulate</a> <a id="1946" class="Symbol">(λ</a> <a id="1949" href="Generic.Syntax.LetCounter.html#1949" class="Bound">_</a> <a id="1951" class="Symbol">→</a> <a id="1953" href="Generic.Syntax.LetCounter.html#825" class="InductiveConstructor">zero</a><a id="1957" class="Symbol">)</a>
    <a id="1963" class="Symbol">}</a>


  <a id="1969" href="Generic.Syntax.LetCounter.html#1969" class="Function">CLet</a> <a id="1974" class="Symbol">:</a> <a id="1976" href="Generic.Syntax.html#527" class="Datatype">Desc</a> <a id="1981" href="Generic.Syntax.LetCounter.html#1115" class="Bound">I</a>
  <a id="1985" href="Generic.Syntax.LetCounter.html#1969" class="Function">CLet</a> <a id="1990" class="Symbol">=</a> <a id="1992" href="Generic.Syntax.html#557" class="InductiveConstructor">`σ</a> <a id="1995" href="Generic.Syntax.LetCounter.html#803" class="Datatype">Counter</a> <a id="2003" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="2005" class="Symbol">λ</a> <a id="2007" href="Generic.Syntax.LetCounter.html#2007" class="Bound">_</a> <a id="2009" class="Symbol">→</a> <a id="2011" href="Generic.Syntax.LetBinder.html#385" class="Function">Let</a>



<a id="2018" class="Keyword">pattern</a> <a id="`IN&#39;"></a><a id="2026" href="Generic.Syntax.LetCounter.html#2026" class="InductiveConstructor">`IN&#39;</a> <a id="2031" href="Generic.Syntax.LetCounter.html#2042" class="Bound">e</a> <a id="2033" href="Generic.Syntax.LetCounter.html#2046" class="Bound">t</a> <a id="2035" class="Symbol">=</a> <a id="2037" class="Symbol">(_</a> <a id="2040" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2042" href="Generic.Syntax.LetCounter.html#2042" class="Bound">e</a> <a id="2044" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2046" href="Generic.Syntax.LetCounter.html#2046" class="Bound">t</a> <a id="2048" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2050" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="2054" class="Symbol">)</a>
<a id="2056" class="Keyword">pattern</a> <a id="`IN"></a><a id="2064" href="Generic.Syntax.LetCounter.html#2064" class="InductiveConstructor">`IN</a>  <a id="2069" href="Generic.Syntax.LetCounter.html#2086" class="Bound">e</a> <a id="2071" href="Generic.Syntax.LetCounter.html#2088" class="Bound">t</a> <a id="2073" class="Symbol">=</a> <a id="2075" href="Generic.Syntax.html#1418" class="InductiveConstructor">`con</a> <a id="2080" class="Symbol">(</a><a id="2081" href="Generic.Syntax.LetCounter.html#2026" class="InductiveConstructor">`IN&#39;</a> <a id="2086" href="Generic.Syntax.LetCounter.html#2086" class="Bound">e</a> <a id="2088" href="Generic.Syntax.LetCounter.html#2088" class="Bound">t</a><a id="2089" class="Symbol">)</a>

<a id="2092" class="Keyword">module</a> <a id="2099" href="Generic.Syntax.LetCounter.html#2099" class="Module">_</a> <a id="2101" class="Symbol">{</a><a id="2102" href="Generic.Syntax.LetCounter.html#2102" class="Bound">I</a> <a id="2104" class="Symbol">:</a> <a id="2106" class="PrimitiveType">Set</a><a id="2109" class="Symbol">}</a> <a id="2111" class="Symbol">{</a><a id="2112" href="Generic.Syntax.LetCounter.html#2112" class="Bound">d</a> <a id="2114" class="Symbol">:</a> <a id="2116" href="Generic.Syntax.html#527" class="Datatype">Desc</a> <a id="2121" href="Generic.Syntax.LetCounter.html#2102" class="Bound">I</a><a id="2122" class="Symbol">}</a> <a id="2124" class="Keyword">where</a>

  <a id="2133" href="Generic.Syntax.LetCounter.html#2133" class="Function">embed</a> <a id="2139" class="Symbol">:</a> <a id="2141" class="Symbol">∀</a> <a id="2143" class="Symbol">{</a><a id="2144" href="Generic.Syntax.LetCounter.html#2144" class="Bound">i</a> <a id="2146" href="Generic.Syntax.LetCounter.html#2146" class="Bound">σ</a><a id="2147" class="Symbol">}</a> <a id="2149" class="Symbol">→</a> <a id="2151" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="2154" href="Generic.Syntax.html#1317" class="Datatype">Tm</a> <a id="2157" href="Generic.Syntax.LetCounter.html#2112" class="Bound">d</a> <a id="2159" href="Generic.Syntax.LetCounter.html#2144" class="Bound">i</a> <a id="2161" href="Generic.Syntax.LetCounter.html#2146" class="Bound">σ</a> <a id="2163" href="Relation.Unary.html#4338" class="Function Operator">⇒</a> <a id="2165" href="Generic.Syntax.html#1317" class="Datatype">Tm</a> <a id="2168" class="Symbol">(</a><a id="2169" href="Generic.Syntax.LetCounter.html#2112" class="Bound">d</a> <a id="2171" href="Generic.Syntax.html#1857" class="Function Operator">`+</a> <a id="2174" href="Generic.Syntax.LetCounter.html#1969" class="Function">CLet</a><a id="2178" class="Symbol">)</a> <a id="2180" href="Generic.Syntax.LetCounter.html#2144" class="Bound">i</a> <a id="2182" href="Generic.Syntax.LetCounter.html#2146" class="Bound">σ</a> <a id="2184" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="2188" href="Generic.Syntax.LetCounter.html#2133" class="Function">embed</a> <a id="2194" class="Symbol">=</a> <a id="2196" href="Generic.Syntax.html#5244" class="Function">map^Tm</a> <a id="2203" class="Symbol">(</a><a id="2204" href="Generic.Syntax.html#5131" class="InductiveConstructor">MkDescMorphism</a> <a id="2219" class="Symbol">(</a><a id="2220" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a> <a id="2225" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,_</a><a id="2227" class="Symbol">))</a>

</pre></body></html>